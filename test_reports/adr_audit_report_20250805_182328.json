{
  "_report_metadata": {
    "generator": "JSONReportGenerator",
    "schema_version": "1.0.0",
    "security_level": "internal",
    "version": "2.0.0"
  },
  "adr_compliance": {
    "ADR-001": {
      "adr_id": "ADR-001",
      "adr_title": "API Authentication Strategy",
      "analysis_metadata": {
        "analysis_methods": [
          "Semantic Claude Code",
          "Static Analysis",
          "Git Forensics",
          "RAG Enhanced"
        ],
        "composite_confidence": 0.92,
        "dimensions_analyzed": 4
      },
      "compliance_score": 85,
      "compliant_areas": [
        "JWT implementation using industry-standard library",
        "Proper token validation in middleware",
        "Secure token storage practices",
        "API key hashing implemented correctly"
      ],
      "insights": [
        {
          "text": "Authentication coverage at 85% - critical gaps in user endpoints",
          "type": "Security"
        },
        {
          "text": "Token validation adds ~50ms latency per request",
          "type": "Performance"
        },
        {
          "text": "Authentication logic well-modularized and testable",
          "type": "Maintenance"
        }
      ],
      "performance_metrics": {
        "cache_hit_rate": 0.65,
        "execution_time": 3.2,
        "tools_executed": [
          "SonarQube",
          "Bandit",
          "PyTestArch"
        ]
      },
      "remediation_plan": {
        "estimated_effort": "2-3 days",
        "priority": "high",
        "steps": [
          "Add authentication decorator to all user endpoints",
          "Update token expiration configuration",
          "Add integration tests for auth flows"
        ]
      },
      "requirements": [
        "All API endpoints must use JWT authentication",
        "Tokens must expire within 15 minutes",
        "Refresh tokens must be used for session management",
        "API keys must be hashed using bcrypt",
        "Rate limiting must be applied per API key"
      ],
      "violations": [
        {
          "adr_id": "ADR-001",
          "description": "API endpoint missing JWT authentication",
          "evidence": "@app.get('/users/{user_id}') # No auth decorator",
          "file_path": "app/api/endpoints/users.py",
          "line_number": 45,
          "risk_level": "high",
          "technical_debt_hours": 4
        },
        {
          "adr_id": "ADR-001",
          "description": "Token expiration set to 60 minutes instead of 15",
          "evidence": "expires_delta=timedelta(minutes=60)",
          "file_path": "app/core/auth.py",
          "line_number": 123,
          "risk_level": "medium",
          "technical_debt_hours": 1
        }
      ]
    },
    "ADR-002": {
      "adr_id": "ADR-002",
      "adr_title": "RBAC Authorization Model",
      "analysis_metadata": {
        "analysis_methods": [
          "Semantic Claude Code",
          "Static Analysis"
        ],
        "composite_confidence": 0.88,
        "dimensions_analyzed": 2
      },
      "compliance_score": 62,
      "compliant_areas": [
        "Role model properly defined in database",
        "Permission system implemented"
      ],
      "insights": [],
      "performance_metrics": {
        "cache_hit_rate": 0,
        "execution_time": 2.8,
        "tools_executed": []
      },
      "remediation_plan": null,
      "requirements": [
        "All endpoints must validate user roles",
        "Role hierarchy must be enforced",
        "Permission checks must be granular"
      ],
      "violations": [
        {
          "adr_id": "ADR-002",
          "description": "Admin endpoint accessible without role check",
          "evidence": "# TODO: Add role validation",
          "file_path": "app/api/endpoints/admin.py",
          "line_number": 78,
          "risk_level": "critical",
          "technical_debt_hours": 8
        }
      ]
    }
  },
  "analysis_steps": [
    {
      "description": "Discovered and analyzed 12.0 Architecture Decision Records",
      "duration": null,
      "findings": [
        "Found 12.0 ADRs in the repository"
      ],
      "name": "ADR Discovery"
    },
    {
      "description": "Analyzed code compliance with each ADR using Claude Code SDK",
      "duration": null,
      "findings": [
        "Identified 3 total violations",
        "Average compliance score: 73.5%"
      ],
      "name": "Compliance Analysis"
    },
    {
      "description": "Analyzed git history and code complexity to identify risk hotspots",
      "duration": null,
      "findings": [
        "Identified 2 architectural hotspots",
        "Critical risk files: 1"
      ],
      "name": "Architectural Hotspot Analysis"
    },
    {
      "description": "All analysis dimensions completed",
      "duration": 42.7,
      "findings": [
        "Total execution time: 42.70 seconds"
      ],
      "name": "Analysis Complete"
    }
  ],
  "hotspot_analysis": {
    "hotspots": [
      {
        "churn_score": 85.0,
        "complexity_score": 78.0,
        "file_path": "app&#x2F;api&#x2F;endpoints&#x2F;admin.py",
        "recommendations": [],
        "risk_category": "Critical",
        "risk_score": 92.0,
        "violation_count": 3.0,
        "violation_history": [
          {
            "message": "ADR-002"
          },
          {
            "message": "ADR-003"
          },
          {
            "message": "ADR-008"
          }
        ]
      },
      {
        "churn_score": 68.0,
        "complexity_score": 62.0,
        "file_path": "app&#x2F;core&#x2F;auth.py",
        "recommendations": [],
        "risk_category": "Critical",
        "risk_score": 75.0,
        "violation_count": 1.0,
        "violation_history": [
          {
            "message": "ADR-001"
          }
        ]
      }
    ],
    "metadata": {
      "analysis_timestamp": "2025-08-05T18:23:28.202190",
      "confidence_threshold": 0.95,
      "statistical_analysis_available": true,
      "temporal_window_months": 6,
      "total_files_analyzed": 2
    },
    "risk_distribution": {
      "critical": 2,
      "high": 0,
      "low": 0,
      "medium": 0,
      "minimal": 0
    },
    "statistics": {
      "average_risk": 0.835,
      "confidence_statistics": {
        "available": true,
        "average_effect_size": null,
        "average_p_value": null,
        "confidence_distribution": {
          "moderate": 0,
          "strong": 0,
          "very_strong": 0,
          "weak": 0
        },
        "high_confidence_percentage": 0.0
      },
      "critical_count": 1,
      "high_risk_count": 1,
      "median_risk": 0.835,
      "risk_distribution": {
        "critical": 1,
        "high": 1,
        "low": 0,
        "medium": 0,
        "minimal": 0
      },
      "risk_std_dev": 0.08500000000000002,
      "temporal_trends": {
        "counts": {
          "degrading": 0,
          "improving": 0,
          "stable": 0,
          "unknown": 2
        },
        "percentages": {
          "degrading": 0.0,
          "improving": 0.0,
          "stable": 0.0,
          "unknown": 100.0
        },
        "summary": "Mixed: 0% improving, 0% degrading"
      },
      "top_risk_areas": [
        {
          "area": "app/api",
          "average_risk": 0.92,
          "file_count": 1,
          "hotspot_count": 1
        },
        {
          "area": "app/core",
          "average_risk": 0.75,
          "file_count": 1,
          "hotspot_count": 1
        }
      ],
      "total_hotspots": 2
    },
    "temporal_trends": {
      "counts": {
        "degrading": 0,
        "improving": 0,
        "stable": 0,
        "unknown": 2
      },
      "percentages": {
        "degrading": 0.0,
        "improving": 0.0,
        "stable": 0.0,
        "unknown": 100.0
      },
      "summary": "Mixed: 0% improving, 0% degrading"
    }
  },
  "hotspots": [
    {
      "churn_score": 85.0,
      "complexity_score": 78.0,
      "file_path": "app/api/endpoints/admin.py",
      "risk_category": "Critical",
      "risk_score": 92.0,
      "violation_count": 3,
      "violation_history": [
        "ADR-002",
        "ADR-003",
        "ADR-008"
      ]
    },
    {
      "churn_score": 68.0,
      "complexity_score": 62.0,
      "file_path": "app/core/auth.py",
      "risk_category": "High",
      "risk_score": 75.0,
      "violation_count": 1,
      "violation_history": [
        "ADR-001"
      ]
    }
  ],
  "metadata": {
    "analysis_duration": 42.7,
    "analysis_mode": "comprehensive",
    "audit_version": "2.0.1",
    "report_generator_version": "2.0.0",
    "report_id": "ff66f8a9-f6f6-457e-b1d1-4fb30bb318d7",
    "repository_path": "/Users/test/violentutf-api",
    "selected_adr": null,
    "timestamp": "2025-08-05T18:23:28.202076",
    "total_files_analyzed": 156.0
  },
  "metrics": {
    "average_violations_per_file": 1.0,
    "compliance_percentage": 73.5,
    "files_with_violations": 3,
    "total_hotspots": 2,
    "total_violations": 3
  },
  "recommendations": [
    {
      "category": "Security",
      "description": "Implement role-based access control for all admin endpoints",
      "effort": "1 week",
      "impact": "Prevents unauthorized access to sensitive operations",
      "priority": "critical"
    },
    {
      "category": "Security",
      "description": "Add authentication to all API endpoints",
      "effort": "3 days",
      "impact": "Ensures all APIs are properly secured",
      "priority": "high"
    },
    {
      "category": "Architecture",
      "description": "Refactor authentication module to reduce complexity",
      "effort": "5 days",
      "impact": "Improves maintainability and reduces bugs",
      "priority": "medium"
    }
  ],
  "summary": {
    "compliance_score": 73.5,
    "critical_violations": 1,
    "high_violations": 1,
    "key_findings": [
      "Warning: Overall compliance score is 73.5%, improvements needed",
      "Found 1 critical violations requiring immediate remediation"
    ],
    "low_violations": 0,
    "medium_violations": 1,
    "risk_assessment": "MEDIUM",
    "technical_debt_days": 1.625,
    "technical_debt_hours": 13.0,
    "total_violations": 3
  },
  "trends": {
    "total_affected_files": 3,
    "total_unique_adrs": 2,
    "violations_by_adr": {
      "ADR-001": 2,
      "ADR-002": 1
    },
    "violations_by_file": {
      "app/api/endpoints/admin.py": 1,
      "app/api/endpoints/users.py": 1,
      "app/core/auth.py": 1
    }
  },
  "violations": [
    {
      "adr_id": "ADR-002",
      "adr_title": "RBAC Authorization Model",
      "category": "Authentication",
      "evidence": "# TODO: Add role validation",
      "file_path": "app/api/endpoints/admin.py",
      "fix_complexity": "Low - Straightforward fix",
      "impact_assessment": "Severe - Potential security breach or compliance failure",
      "line_number": 78,
      "remediation_guidance": "Implement role-based access control",
      "risk_level": "critical",
      "technical_debt_hours": 8.0
    },
    {
      "adr_id": "ADR-001",
      "adr_title": "API Authentication Strategy",
      "category": "API Design",
      "evidence": "@app.get('/users/{user_id}') # No auth decorator",
      "file_path": "app/api/endpoints/users.py",
      "fix_complexity": "Low - Straightforward fix",
      "impact_assessment": "High - Significant operational or security risk",
      "line_number": 45,
      "remediation_guidance": "Add @require_auth decorator to endpoint",
      "risk_level": "high",
      "technical_debt_hours": 4.0
    },
    {
      "adr_id": "ADR-001",
      "adr_title": "API Authentication Strategy",
      "category": "API Design",
      "evidence": "expires_delta=timedelta(minutes=60)",
      "file_path": "app/core/auth.py",
      "fix_complexity": "Low - Straightforward fix",
      "impact_assessment": "Moderate - May impact system reliability or maintainability",
      "line_number": 123,
      "remediation_guidance": "Update to timedelta(minutes=15)",
      "risk_level": "medium",
      "technical_debt_hours": 1.0
    }
  ]
}
