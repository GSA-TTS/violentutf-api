{
  "status": "not_fixed",
  "tool_name": "pytest",
  "exit_code": 1,
  "test_file_name": "test_sessions.py",
  "failure_type": "DEPENDENCY_INJECTION_ERROR",
  "failure_subtype": "AttributeError",
  "file_path": "tests/unit/api/test_sessions.py",
  "file_path_log": [],
  "issue": "Tests patching SessionRepository but endpoints use SessionService dependency injection",
  "issue_log": [],
  "line_range": "273",
  "severity": "HIGH",
  "message": "<module 'app.api.endpoints.sessions' from '/path'> does not have the attribute 'SessionRepository'",
  "offending_code_snippet": "with patch(\"app.api.endpoints.sessions.SessionRepository\") as mock_repo_class:",
  "structured_details": {
    "endpoint_dependency": "get_session_service",
    "actual_service": "SessionService",
    "test_pattern": "repository_patching",
    "required_pattern": "service_dependency_injection",
    "failing_tests": [
      "test_create_session",
      "test_create_session_duplicate_token",
      "test_get_my_sessions",
      "test_revoke_session",
      "test_revoke_all_user_sessions",
      "test_extend_session",
      "test_get_active_sessions_admin_only",
      "test_get_session_statistics_admin_only",
      "test_admin_endpoints_unauthorized",
      "test_session_ownership_check"
    ]
  },
  "solution": [
    "Replace repository patching with service dependency injection",
    "Use app.dependency_overrides[get_session_service] = lambda: mock_service",
    "Create mock_session_service instead of mock_session_repo",
    "Update all test methods to use service mocking pattern",
    "Ensure mock service methods match SessionService interface"
  ]
}
