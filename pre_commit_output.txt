black....................................................................Failed
- hook id: black
- exit code: 123

error: cannot format tools/pre_audit/multi_agent_auditor.py: Cannot parse for target version Python 3.12: 205:8:         }

isort....................................................................Passed
flake8-critical-errors...................................................Failed
- hook id: flake8
- exit code: 1

tools/pre_audit/multi_agent_auditor.py
1     E999 SyntaxError: unmatched '}'
1

mypy.....................................................................Failed
- hook id: mypy
- exit code: 2

tools/pre_audit/multi_agent_auditor.py:205: error: Unmatched '}'  [syntax]
Found 1 error in 1 file (errors prevented further checking)

bandit-comprehensive.....................................................Failed
- hook id: bandit
- exit code: 1

[main]	INFO	profile include tests: None
[main]	INFO	profile exclude tests: None
[main]	INFO	cli include tests: None
[main]	INFO	cli exclude tests: B101,B601
[main]	INFO	running on Python 3.12.9
[manager]	WARNING	Test in comment: Needed is not a test name or id, ignoring
[manager]	WARNING	Test in comment: for is not a test name or id, ignoring
[manager]	WARNING	Test in comment: workflow is not a test name or id, ignoring
[manager]	WARNING	Test in comment: execution is not a test name or id, ignoring
[manager]	WARNING	Test in comment: testing is not a test name or id, ignoring
[manager]	WARNING	Test in comment: Safe is not a test name or id, ignoring
[manager]	WARNING	Test in comment: bash is not a test name or id, ignoring
[manager]	WARNING	Test in comment: syntax is not a test name or id, ignoring
[manager]	WARNING	Test in comment: checking is not a test name or id, ignoring
[manager]	WARNING	Test in comment: Safe is not a test name or id, ignoring
[manager]	WARNING	Test in comment: testing is not a test name or id, ignoring
[manager]	WARNING	Test in comment: with is not a test name or id, ignoring
[manager]	WARNING	Test in comment: controlled is not a test name or id, ignoring
[manager]	WARNING	Test in comment: input is not a test name or id, ignoring
[manager]	WARNING	Test in comment: Safe is not a test name or id, ignoring
[manager]	WARNING	Test in comment: bash is not a test name or id, ignoring
[manager]	WARNING	Test in comment: syntax is not a test name or id, ignoring
[manager]	WARNING	Test in comment: checking is not a test name or id, ignoring
[manager]	WARNING	Test in comment: Needed is not a test name or id, ignoring
[manager]	WARNING	Test in comment: for is not a test name or id, ignoring
[manager]	WARNING	Test in comment: workflow is not a test name or id, ignoring
[manager]	WARNING	Test in comment: validation is not a test name or id, ignoring
[manager]	WARNING	Test in comment: testing is not a test name or id, ignoring
[manager]	WARNING	Test in comment: Safe is not a test name or id, ignoring
[manager]	WARNING	Test in comment: bash is not a test name or id, ignoring
[manager]	WARNING	Test in comment: syntax is not a test name or id, ignoring
[manager]	WARNING	Test in comment: checking is not a test name or id, ignoring
[manager]	WARNING	Test in comment: Safe is not a test name or id, ignoring
[manager]	WARNING	Test in comment: bash is not a test name or id, ignoring
[manager]	WARNING	Test in comment: syntax is not a test name or id, ignoring
[manager]	WARNING	Test in comment: checking is not a test name or id, ignoring
[manager]	WARNING	Test in comment: Standard is not a test name or id, ignoring
[manager]	WARNING	Test in comment: OAuth2 is not a test name or id, ignoring
[manager]	WARNING	Test in comment: token is not a test name or id, ignoring
[manager]	WARNING	Test in comment: type is not a test name or id, ignoring
[manager]	WARNING	Test in comment: Standard is not a test name or id, ignoring
[manager]	WARNING	Test in comment: OAuth2 is not a test name or id, ignoring
[manager]	WARNING	Test in comment: grant is not a test name or id, ignoring
[manager]	WARNING	Test in comment: type is not a test name or id, ignoring
[manager]	WARNING	Test in comment: Intentional is not a test name or id, ignoring
[manager]	WARNING	Test in comment: for is not a test name or id, ignoring
[manager]	WARNING	Test in comment: configuration is not a test name or id, ignoring
[manager]	WARNING	Test in comment: validation is not a test name or id, ignoring
[manager]	WARNING	Test in comment: Standard is not a test name or id, ignoring
[manager]	WARNING	Test in comment: JWT is not a test name or id, ignoring
[manager]	WARNING	Test in comment: token is not a test name or id, ignoring
[manager]	WARNING	Test in comment: type is not a test name or id, ignoring
[manager]	WARNING	Test in comment: Standard is not a test name or id, ignoring
[manager]	WARNING	Test in comment: JWT is not a test name or id, ignoring
[manager]	WARNING	Test in comment: token is not a test name or id, ignoring
[manager]	WARNING	Test in comment: type is not a test name or id, ignoring
[manager]	WARNING	Test in comment: Standard is not a test name or id, ignoring
[manager]	WARNING	Test in comment: OAuth2 is not a test name or id, ignoring
[manager]	WARNING	Test in comment: token is not a test name or id, ignoring
[manager]	WARNING	Test in comment: hint is not a test name or id, ignoring
[manager]	WARNING	Test in comment: Standard is not a test name or id, ignoring
[manager]	WARNING	Test in comment: OAuth2 is not a test name or id, ignoring
[manager]	WARNING	Test in comment: token is not a test name or id, ignoring
[manager]	WARNING	Test in comment: hint is not a test name or id, ignoring
[tester]	WARNING	nosec encountered (B608), but no failed test on line 65
[tester]	WARNING	nosec encountered (B608), but no failed test on line 417
[tester]	WARNING	nosec encountered (B608), but no failed test on line 417
[manager]	WARNING	Test in comment: test is not a test name or id, ignoring
[manager]	WARNING	Test in comment: data is not a test name or id, ignoring
[tester]	WARNING	nosec encountered (B608), but no failed test on line 423
[tester]	WARNING	nosec encountered (B608), but no failed test on line 424
[tester]	WARNING	nosec encountered (B608), but no failed test on line 425
[tester]	WARNING	nosec encountered (B608), but no failed test on line 426
[tester]	WARNING	nosec encountered (B608), but no failed test on line 512
[manager]	WARNING	Test in comment: Test is not a test name or id, ignoring
[manager]	WARNING	Test in comment: case is not a test name or id, ignoring
[manager]	WARNING	Test in comment: for is not a test name or id, ignoring
[manager]	WARNING	Test in comment: IP is not a test name or id, ignoring
[manager]	WARNING	Test in comment: validation is not a test name or id, ignoring
[tester]	WARNING	nosec encountered (B608), but no failed test on line 433
[tester]	WARNING	nosec encountered (B104), but no failed test on line 111
[tester]	WARNING	nosec encountered (B104), but no failed test on line 111
[tester]	WARNING	nosec encountered (B104), but no failed test on line 111
[tester]	WARNING	nosec encountered (B104), but no failed test on line 111
[tester]	WARNING	nosec encountered (B104), but no failed test on line 130
[tester]	WARNING	nosec encountered (B104), but no failed test on line 130
[tester]	WARNING	nosec encountered (B104), but no failed test on line 130
[tester]	WARNING	nosec encountered (B104), but no failed test on line 130
[manager]	WARNING	Test in comment: see is not a test name or id, ignoring
[manager]	WARNING	Test in comment: security is not a test name or id, ignoring
[manager]	WARNING	Test in comment: note is not a test name or id, ignoring
[manager]	WARNING	Test in comment: in is not a test name or id, ignoring
[manager]	WARNING	Test in comment: module is not a test name or id, ignoring
[manager]	WARNING	Test in comment: docstring is not a test name or id, ignoring
[manager]	WARNING	Test in comment: see is not a test name or id, ignoring
[manager]	WARNING	Test in comment: security is not a test name or id, ignoring
[manager]	WARNING	Test in comment: note is not a test name or id, ignoring
[manager]	WARNING	Test in comment: in is not a test name or id, ignoring
[manager]	WARNING	Test in comment: module is not a test name or id, ignoring
[manager]	WARNING	Test in comment: docstring is not a test name or id, ignoring
[manager]	WARNING	Test in comment: see is not a test name or id, ignoring
[manager]	WARNING	Test in comment: security is not a test name or id, ignoring
[manager]	WARNING	Test in comment: note is not a test name or id, ignoring
[manager]	WARNING	Test in comment: in is not a test name or id, ignoring
[manager]	WARNING	Test in comment: module is not a test name or id, ignoring
[manager]	WARNING	Test in comment: docstring is not a test name or id, ignoring
[manager]	WARNING	Test in comment: see is not a test name or id, ignoring
[manager]	WARNING	Test in comment: security is not a test name or id, ignoring
[manager]	WARNING	Test in comment: note is not a test name or id, ignoring
[manager]	WARNING	Test in comment: in is not a test name or id, ignoring
[manager]	WARNING	Test in comment: module is not a test name or id, ignoring
[manager]	WARNING	Test in comment: docstring is not a test name or id, ignoring
[manager]	WARNING	Test in comment: see is not a test name or id, ignoring
[manager]	WARNING	Test in comment: security is not a test name or id, ignoring
[manager]	WARNING	Test in comment: note is not a test name or id, ignoring
[manager]	WARNING	Test in comment: in is not a test name or id, ignoring
[manager]	WARNING	Test in comment: module is not a test name or id, ignoring
[manager]	WARNING	Test in comment: docstring is not a test name or id, ignoring
[manager]	WARNING	Test in comment: internal is not a test name or id, ignoring
[manager]	WARNING	Test in comment: cache is not a test name or id, ignoring
[manager]	WARNING	Test in comment: only is not a test name or id, ignoring
[manager]	WARNING	Test in comment: internal is not a test name or id, ignoring
[manager]	WARNING	Test in comment: cache is not a test name or id, ignoring
[manager]	WARNING	Test in comment: only is not a test name or id, ignoring
Working... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:02
Run started:2025-08-03 14:30:54.844617

Test results:
>> Issue: [B103:set_bad_file_permissions] Chmod setting a permissive mask 0o755 on file (repo_path).
   Severity: Medium   Confidence: High
   CWE: CWE-732 (https://cwe.mitre.org/data/definitions/732.html)
   More Info: https://bandit.readthedocs.io/en/0.0.0/plugins/b103_set_bad_file_permissions.html
   Location: ./tests/unit/test_git_history_parser_comprehensive.py:317:12
316	            # Restore permissions for cleanup
317	            os.chmod(repo_path, 0o755)
318

--------------------------------------------------

Code scanned:
	Total lines of code: 76212
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 32

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 329
		Medium: 1
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 207
		High: 123
Files skipped (1):
	./tools/pre_audit/multi_agent_auditor.py (syntax error while parsing AST from file)

detect-secrets-comprehensive.............................................Passed
prettier.............................................(no files to check)Skipped
shellcheck...............................................................Passed
Hadolint.................................................................Passed
trim trailing whitespace.................................................Passed
fix end of files.........................................................Passed
check yaml...............................................................Passed
check json...............................................................Passed
check for added large files..............................................Passed
check for case conflicts.................................................Passed
check for merge conflicts................................................Passed
check that executables have shebangs.....................................Passed
check that scripts with shebangs are executable..........................Passed
detect private key.......................................................Passed
Core Unit Tests (stricter than CI).......................................Failed
- hook id: unit-tests
- exit code: 1

Repository root: /Users/tamnguyen/Documents/GitHub/violentutf-api
PYTHONPATH: /Users/tamnguyen/Documents/GitHub/violentutf-api:
Python executable: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pytest_asyncio/plugin.py:208: PytestDeprecationWarning: The configuration option "asyncio_default_fixture_loop_scope" is unset.
The event loop scope for asynchronous fixtures will default to the fixture caching scope. Future versions of pytest-asyncio will default the loop scope for asynchronous fixtures to function scope. Set the default fixture loop scope explicitly in order to avoid unexpected behavior in the future. Valid fixture loop scopes are: "function", "class", "module", "package", "session"

  warnings.warn(PytestDeprecationWarning(_DEFAULT_FIXTURE_LOOP_SCOPE_UNSET))
============================= test session starts ==============================
platform darwin -- Python 3.12.9, pytest-8.3.5, pluggy-1.5.0 -- /Library/Frameworks/Python.framework/Versions/3.12/bin/python3
cachedir: .pytest_cache
metadata: {'Python': '3.12.9', 'Platform': 'macOS-15.5-arm64-arm-64bit', 'Packages': {'pytest': '8.3.5', 'pluggy': '1.5.0'}, 'Plugins': {'xdist': '3.7.0', 'anyio': '4.9.0', 'env': '1.1.5', 'json-report': '1.5.0', 'httpx': '0.35.0', 'timeout': '2.4.0', 'metadata': '3.1.1', 'cov': '6.2.1', 'Faker': '37.3.0', 'mock': '3.14.1', 'asyncio': '1.0.0'}}
rootdir: /Users/tamnguyen/Documents/GitHub/violentutf-api
configfile: pytest.ini
plugins: xdist-3.7.0, anyio-4.9.0, env-1.1.5, json-report-1.5.0, httpx-0.35.0, timeout-2.4.0, metadata-3.1.1, cov-6.2.1, Faker-37.3.0, mock-3.14.1, asyncio-1.0.0
timeout: 60.0s
timeout method: signal
timeout func_only: False
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 1759 items / 1 deselected / 1758 selected

tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_list_api_keys PASSED [  0%]
tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_get_api_key_by_id PASSED [  0%]
tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_create_api_key PASSED [  0%]
tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_create_api_key_duplicate_name PASSED [  0%]
tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_update_api_key PASSED [  0%]
tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_delete_api_key PASSED [  0%]
tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_get_my_api_keys PASSED [  0%]
tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_revoke_api_key PASSED [  0%]
tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_validate_api_key PASSED [  0%]
tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_get_permission_templates PASSED [  0%]
tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_get_usage_statistics_admin_only PASSED [  0%]
tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_usage_statistics_unauthorized PASSED [  0%]
tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_permission_validation PASSED [  0%]
tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_api_key_expiration PASSED [  0%]
tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_api_key_ownership_check PASSED [  0%]
tests/unit/api/test_audit_logs.py::TestAuditLogEndpoints::test_list_audit_logs_admin_only PASSED [  0%]
tests/unit/api/test_audit_logs.py::TestAuditLogEndpoints::test_list_audit_logs_with_filters PASSED [  0%]
tests/unit/api/test_audit_logs.py::TestAuditLogEndpoints::test_get_audit_log_by_id PASSED [  1%]
tests/unit/api/test_audit_logs.py::TestAuditLogEndpoints::test_get_user_audit_logs PASSED [  1%]
tests/unit/api/test_audit_logs.py::TestAuditLogEndpoints::test_get_resource_audit_logs PASSED [  1%]
tests/unit/api/test_audit_logs.py::TestAuditLogEndpoints::test_get_audit_log_statistics PASSED [  1%]
tests/unit/api/test_audit_logs.py::TestAuditLogEndpoints::test_get_resource_audit_summary PASSED [  1%]
tests/unit/api/test_audit_logs.py::TestAuditLogEndpoints::test_export_audit_logs_csv PASSED [  1%]
tests/unit/api/test_audit_logs.py::TestAuditLogEndpoints::test_export_audit_logs_json PASSED [  1%]
tests/unit/api/test_audit_logs.py::TestAuditLogEndpoints::test_audit_logs_require_admin PASSED [  1%]
tests/unit/api/test_audit_logs.py::TestAuditLogEndpoints::test_user_can_view_own_audit_logs PASSED [  1%]
tests/unit/api/test_audit_logs.py::TestAuditLogEndpoints::test_export_validation PASSED [  1%]
tests/unit/api/test_audit_logs.py::TestAuditLogEndpoints::test_audit_log_not_found PASSED [  1%]
tests/unit/api/test_audit_logs.py::TestAuditLogEndpoints::test_resource_summary_not_found PASSED [  1%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_login_success_returns_enhanced_jwt_claims PASSED [  1%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_login_invalid_credentials_security_response PASSED [  1%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_login_malformed_request_handling PASSED [  1%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_login_rate_limiting_protection PASSED [  1%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_login_sql_injection_protection PASSED [  1%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_login_timing_attack_resistance PASSED [  1%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_registration_password_strength_validation PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_registration_email_validation PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_registration_username_validation PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_registration_duplicate_prevention PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_registration_assigns_default_roles PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_refresh_token_security_validation PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_refresh_token_reuse_prevention PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_logout_token_invalidation PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_password_reset_email_validation PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_password_reset_rate_limiting PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_password_reset_information_disclosure_prevention PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_email_verification_token_validation PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_auth_endpoints_csrf_protection PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_auth_endpoints_content_type_validation PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_auth_endpoints_request_size_limits PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_auth_endpoints_security_headers PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestAuthEndpointsSecurity::test_auth_endpoints_error_response_consistency PASSED [  2%]
tests/unit/api/test_auth_endpoints_security.py::TestJWTSecurityValidation::test_jwt_signature_validation PASSED [  3%]
tests/unit/api/test_auth_endpoints_security.py::TestJWTSecurityValidation::test_jwt_expiration_validation PASSED [  3%]
tests/unit/api/test_auth_endpoints_security.py::TestJWTSecurityValidation::test_jwt_algorithm_validation PASSED [  3%]
tests/unit/api/test_auth_endpoints_security.py::TestJWTSecurityValidation::test_jwt_claims_injection_prevention PASSED [  3%]
tests/unit/api/test_auth_endpoints_security.py::TestJWTSecurityValidation::test_jwt_token_substitution_attack_prevention PASSED [  3%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_list_sessions PASSED [  3%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_get_session_by_id PASSED [  3%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_create_session PASSED [  3%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_create_session_duplicate_token PASSED [  3%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_update_session PASSED [  3%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_delete_session PASSED [  3%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_get_my_sessions PASSED [  3%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_revoke_session PASSED [  3%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_revoke_all_user_sessions PASSED [  3%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_extend_session PASSED [  3%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_get_active_sessions_admin_only PASSED [  3%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_get_session_statistics_admin_only PASSED [  3%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_admin_endpoints_unauthorized PASSED [  3%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_session_ownership_check PASSED [  4%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_session_token_validation PASSED [  4%]
tests/unit/api/test_sessions.py::TestSessionEndpoints::test_extend_session_validation PASSED [  4%]
tests/unit/api/test_users.py::TestUserEndpoints::test_list_users PASSED  [  4%]
tests/unit/api/test_users.py::TestUserEndpoints::test_get_user_by_id PASSED [  4%]
tests/unit/api/test_users.py::TestUserEndpoints::test_get_user_not_found PASSED [  4%]
tests/unit/api/test_users.py::TestUserEndpoints::test_create_user PASSED [  4%]
tests/unit/api/test_users.py::TestUserEndpoints::test_create_user_duplicate_username PASSED [  4%]
tests/unit/api/test_users.py::TestUserEndpoints::test_update_user PASSED [  4%]
tests/unit/api/test_users.py::TestUserEndpoints::test_delete_user PASSED [  4%]
tests/unit/api/test_users.py::TestUserEndpoints::test_get_current_user PASSED [  4%]
tests/unit/api/test_users.py::TestUserEndpoints::test_update_current_user PASSED [  4%]
tests/unit/api/test_users.py::TestUserEndpoints::test_change_password PASSED [  4%]
tests/unit/api/test_users.py::TestUserEndpoints::test_change_password_incorrect_current PASSED [  4%]
tests/unit/api/test_users.py::TestUserEndpoints::test_get_user_by_username PASSED [  4%]
tests/unit/api/test_users.py::TestUserEndpoints::test_verify_user_email PASSED [  4%]
tests/unit/api/test_users.py::TestUserEndpoints::test_activate_user PASSED [  4%]
tests/unit/api/test_users.py::TestUserEndpoints::test_deactivate_user PASSED [  5%]
tests/unit/api/test_users.py::TestUserEndpoints::test_admin_only_endpoints_unauthorized PASSED [  5%]
tests/unit/api/test_users.py::TestUserEndpoints::test_input_validation PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestFieldValidationRule::test_field_validation_rule_creation PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestFieldValidationRule::test_field_validation_rule_with_custom_validator PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestValidationConfig::test_default_validation_config PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestValidationConfig::test_custom_validation_config PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestStringFieldValidation::test_validate_string_field_success PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestStringFieldValidation::test_validate_string_field_strips_whitespace PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestStringFieldValidation::test_validate_string_field_too_short PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestStringFieldValidation::test_validate_string_field_too_long PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestStringFieldValidation::test_validate_string_field_pattern_match PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestStringFieldValidation::test_validate_string_field_sql_injection_strict PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestStringFieldValidation::test_validate_string_field_sql_injection_moderate PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestStringFieldValidation::test_validate_string_field_xss_strict PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestStringFieldValidation::test_validate_string_field_required PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestStringFieldValidation::test_validate_string_field_optional PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestNumericFieldValidation::test_validate_numeric_field_int PASSED [  5%]
tests/unit/core/test_core_input_validation.py::TestNumericFieldValidation::test_validate_numeric_field_float PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestNumericFieldValidation::test_validate_numeric_field_decimal PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestNumericFieldValidation::test_validate_numeric_field_range_validation PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestNumericFieldValidation::test_validate_numeric_field_allowed_values PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestValidateField::test_validate_field_with_custom_validator PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestValidateField::test_validate_field_boolean PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestValidateField::test_validate_field_datetime PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestValidateRequestData::test_validate_request_data_success PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestValidateRequestData::test_validate_request_data_missing_required_field PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestValidateRequestData::test_validate_request_data_extra_fields_rejected PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestValidateRequestData::test_validate_request_data_extra_fields_allowed PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestValidateJsonInput::test_validate_json_input_success PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestValidateJsonInput::test_validate_json_input_too_deep PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestValidateJsonInput::test_validate_json_input_too_many_keys PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestValidateQueryParams::test_validate_query_params_success PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestValidateQueryParams::test_validate_query_params_unexpected_rejected PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestValidateQueryParams::test_validate_query_params_sql_injection_check PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestValidationDecorator::test_validate_input_decorator_query_params PASSED [  6%]
tests/unit/core/test_core_input_validation.py::TestValidationDecorator::test_validate_input_decorator_json_body PASSED [  7%]
tests/unit/core/test_core_input_validation.py::TestValidationDecorator::test_validate_input_decorator_validation_failure SKIPPED [  7%]
tests/unit/core/test_core_input_validation.py::TestSpecificFieldValidators::test_validate_email_field_success PASSED [  7%]
tests/unit/core/test_core_input_validation.py::TestSpecificFieldValidators::test_validate_email_field_invalid PASSED [  7%]
tests/unit/core/test_core_input_validation.py::TestSpecificFieldValidators::test_validate_url_field_success PASSED [  7%]
tests/unit/core/test_core_input_validation.py::TestSpecificFieldValidators::test_validate_url_field_invalid_scheme PASSED [  7%]
tests/unit/core/test_core_input_validation.py::TestSpecificFieldValidators::test_validate_ip_field_success PASSED [  7%]
tests/unit/core/test_core_input_validation.py::TestSpecificFieldValidators::test_validate_ip_field_invalid PASSED [  7%]
tests/unit/core/test_core_input_validation.py::TestCommonValidationRules::test_username_rule PASSED [  7%]
tests/unit/core/test_core_input_validation.py::TestCommonValidationRules::test_password_rule PASSED [  7%]
tests/unit/core/test_core_input_validation.py::TestCommonValidationRules::test_email_rule PASSED [  7%]
tests/unit/core/test_core_input_validation.py::TestCommonValidationRules::test_api_key_name_rule PASSED [  7%]
tests/unit/core/test_core_input_validation.py::TestValidationLevels::test_strict_level_rejects_on_warnings PASSED [  7%]
tests/unit/core/test_core_input_validation.py::TestValidationLevels::test_moderate_level_logs_warnings PASSED [  7%]
tests/unit/core/test_core_input_validation.py::TestValidationLevels::test_lenient_level_skips_security_checks PASSED [  7%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitKey::test_get_rate_limit_key_with_organization PASSED [  7%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitKey::test_get_rate_limit_key_with_user_only PASSED [  7%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitKey::test_get_rate_limit_key_with_api_key PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitKey::test_get_rate_limit_key_fallback_to_ip PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitConfiguration::test_get_rate_limit_known_endpoint PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitConfiguration::test_get_rate_limit_unknown_endpoint PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitConfiguration::test_rate_limits_configuration PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitDecorator::test_rate_limit_disabled PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitDecorator::test_rate_limit_enabled_no_request_param PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitDecorator::test_rate_limit_enabled_with_request_param PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitDecorator::test_ip_rate_limit_disabled PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitDecorator::test_ip_rate_limit_enabled PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitStatus::test_get_rate_limit_status_disabled PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitStatus::test_get_rate_limit_status_enabled PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestCustomRateLimitException::test_rate_limit_exceeded_basic PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestCustomRateLimitException::test_rate_limit_exceeded_with_retry_after PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitIntegration::test_rate_limit_decorator_exception_handling PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitIntegration::test_rate_limit_configuration_completeness PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitIntegration::test_rate_limit_key_without_state PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitAsyncBehavior::test_rate_limit_decorator_async_function PASSED [  8%]
tests/unit/core/test_core_rate_limiting.py::TestRateLimitAsyncBehavior::test_ip_rate_limit_decorator_async_function PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestSignatureComponents::test_get_hash_function PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestSignatureComponents::test_compute_body_hash PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestSignatureComponents::test_create_signing_string PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestRequestSigning::test_sign_request PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestRequestSigning::test_verify_signature_valid PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestRequestSigning::test_verify_signature_invalid PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestRequestSigning::test_verify_signature_expired PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestRequestSigning::test_verify_signature_future_timestamp PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestRequestSigning::test_verify_signature_replay_attack PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestAuthorizationHeader::test_parse_authorization_header_valid PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestAuthorizationHeader::test_parse_authorization_header_invalid PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestAuthorizationHeader::test_format_authorization_header PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestSignatureKeyStore::test_key_store_operations PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestNonceCache::test_nonce_cache_operations PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestNonceCache::test_nonce_cache_expiration PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestNonceCache::test_nonce_cache_clear PASSED [  9%]
tests/unit/core/test_core_request_signing.py::TestRequestSigningDecorators::test_require_request_signature_valid PASSED [ 10%]
tests/unit/core/test_core_request_signing.py::TestRequestSigningDecorators::test_require_request_signature_missing PASSED [ 10%]
tests/unit/core/test_core_request_signing.py::TestRequestSigningDecorators::test_require_admin_signature_valid PASSED [ 10%]
tests/unit/core/test_core_request_signing.py::TestRequestSigningDecorators::test_require_admin_signature_non_admin_key PASSED [ 10%]
tests/unit/core/test_core_request_signing.py::TestRequestSigningDecorators::test_verify_webhook_signature_valid PASSED [ 10%]
tests/unit/core/test_core_request_signing.py::TestRequestSigningDecorators::test_verify_webhook_signature_invalid PASSED [ 10%]
tests/unit/core/test_core_request_signing.py::TestRequestSigningDecorators::test_verify_webhook_signature_expired PASSED [ 10%]
tests/unit/core/test_core_request_signing.py::TestRequestSigningDecorators::test_sync_endpoint_not_supported PASSED [ 10%]
tests/unit/core/test_external_services.py::TestExternalServiceConfig::test_default_config PASSED [ 10%]
tests/unit/core/test_external_services.py::TestExternalServiceConfig::test_custom_config PASSED [ 10%]
tests/unit/core/test_external_services.py::TestExternalServiceConfig::test_invalid_base_url PASSED [ 10%]
tests/unit/core/test_external_services.py::TestServiceError::test_error_creation PASSED [ 10%]
tests/unit/core/test_external_services.py::TestExternalServiceClient::test_client_initialization PASSED [ 10%]
tests/unit/core/test_external_services.py::TestExternalServiceClient::test_context_manager PASSED [ 10%]
tests/unit/core/test_external_services.py::TestExternalServiceClient::test_successful_request PASSED [ 10%]
tests/unit/core/test_external_services.py::TestExternalServiceClient::test_request_with_response_model PASSED [ 10%]
tests/unit/core/test_external_services.py::TestExternalServiceClient::test_http_error PASSED [ 10%]
tests/unit/core/test_external_services.py::TestExternalServiceClient::test_connection_error PASSED [ 10%]
tests/unit/core/test_external_services.py::TestExternalServiceClient::test_circuit_breaker_integration PASSED [ 11%]
tests/unit/core/test_external_services.py::TestExternalServiceClient::test_retry_behavior PASSED [ 11%]
tests/unit/core/test_external_services.py::TestExternalServiceClient::test_health_check_no_endpoint PASSED [ 11%]
tests/unit/core/test_external_services.py::TestExternalServiceClient::test_health_check_with_endpoint PASSED [ 11%]
tests/unit/core/test_external_services.py::TestExternalServiceClient::test_get_circuit_breaker_stats PASSED [ 11%]
tests/unit/core/test_external_services.py::TestServiceRegistry::test_register_service PASSED [ 11%]
tests/unit/core/test_external_services.py::TestServiceRegistry::test_register_duplicate_service PASSED [ 11%]
tests/unit/core/test_external_services.py::TestServiceRegistry::test_get_nonexistent_service PASSED [ 11%]
tests/unit/core/test_external_services.py::TestServiceRegistry::test_get_all_services_health PASSED [ 11%]
tests/unit/core/test_external_services.py::TestServiceRegistry::test_close_all_services PASSED [ 11%]
tests/unit/core/test_external_services.py::TestIntegration::test_full_request_flow PASSED [ 11%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_sanitize_email_field PASSED [ 11%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_sanitize_phone_field PASSED [ 11%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_sanitize_field_html PASSED [ 11%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_sanitize_field_sql PASSED [ 11%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_sanitize_field_filename PASSED [ 11%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_sanitize_field_url PASSED [ 11%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_sanitize_field_ai_prompt PASSED [ 12%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_sanitize_field_multiple_types PASSED [ 12%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_sanitize_field_custom_sanitizer PASSED [ 12%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_sanitize_field_remove_patterns PASSED [ 12%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_sanitize_field_whitespace_handling PASSED [ 12%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_sanitize_field_case_preservation PASSED [ 12%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_sanitize_field_none_level PASSED [ 12%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_sanitize_field_error_handling PASSED [ 12%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_sanitize_request_data PASSED [ 12%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_predefined_rules PASSED [ 12%]
tests/unit/core/test_field_sanitization.py::TestFieldSanitization::test_create_sanitization_middleware PASSED [ 12%]
tests/unit/core/test_field_sanitization.py::TestIntegrationScenarios::test_registration_form_sanitization PASSED [ 12%]
tests/unit/core/test_field_sanitization.py::TestIntegrationScenarios::test_file_upload_sanitization PASSED [ 12%]
tests/unit/core/test_field_sanitization.py::TestIntegrationScenarios::test_api_request_sanitization PASSED [ 12%]
tests/unit/core/test_session.py::TestSessionManager::test_create_session_success PASSED [ 12%]
tests/unit/core/test_session.py::TestSessionManager::test_create_session_without_cache PASSED [ 12%]
tests/unit/core/test_session.py::TestSessionManager::test_get_session_success PASSED [ 12%]
tests/unit/core/test_session.py::TestSessionManager::test_get_session_not_found PASSED [ 12%]
tests/unit/core/test_session.py::TestSessionManager::test_get_session_without_cache PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManager::test_rotate_session_success PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManager::test_rotate_session_not_found PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManager::test_delete_session_success PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManager::test_delete_session_not_found PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManager::test_extend_session_success PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManager::test_extend_session_not_found PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManager::test_validate_session_success PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManager::test_validate_session_not_found PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManager::test_validate_session_ip_mismatch PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManager::test_cleanup_expired_sessions PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManager::test_session_manager_cache_error_handling PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManager::test_cache_error_handling[get_session-args0] PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManager::test_cache_error_handling[delete_session-args1] PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManager::test_cache_error_handling[extend_session-args2] PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManagerSingleton::test_get_session_manager_singleton PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManagerSingleton::test_session_manager_initialization PASSED [ 13%]
tests/unit/core/test_session.py::TestSessionManagerSingleton::test_session_ttl_configuration PASSED [ 13%]
tests/unit/core/test_session_comprehensive.py::TestSessionManagerInitialization::test_init_with_cache PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestSessionManagerInitialization::test_init_without_cache PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestSessionManagerInitialization::test_init_with_different_ttl_settings PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestCreateSession::test_create_session_basic PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestCreateSession::test_create_session_with_ip_and_ua PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestCreateSession::test_create_session_generates_unique_ids PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestCreateSession::test_create_session_with_ttl PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestCreateSession::test_create_session_cache_failure PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestCreateSession::test_create_session_without_cache PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestCreateSession::test_create_session_logs_info PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestCreateSession::test_create_session_logs_error_on_failure PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestGetSession::test_get_session_exists PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestGetSession::test_get_session_not_found PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestGetSession::test_get_session_updates_last_accessed PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestGetSession::test_get_session_without_cache PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestGetSession::test_get_session_cache_error PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestGetSession::test_get_session_set_error_after_get PASSED [ 14%]
tests/unit/core/test_session_comprehensive.py::TestRotateSession::test_rotate_session_success PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestRotateSession::test_rotate_session_not_found PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestRotateSession::test_rotate_session_with_new_ip_ua PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestRotateSession::test_rotate_session_cache_failure PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestRotateSession::test_rotate_session_without_cache PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestRotateSession::test_rotate_session_logs_info PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestDeleteSession::test_delete_session_success PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestDeleteSession::test_delete_session_not_found PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestDeleteSession::test_delete_session_without_cache PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestDeleteSession::test_delete_session_cache_error PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestDeleteSession::test_delete_session_logs_info PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestDeleteUserSessions::test_delete_user_sessions_without_cache PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestDeleteUserSessions::test_delete_user_sessions_logs_info PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestDeleteUserSessions::test_delete_user_sessions_exception PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestExtendSession::test_extend_session_success PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestExtendSession::test_extend_session_not_found PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestExtendSession::test_extend_session_without_cache PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestExtendSession::test_extend_session_cache_error PASSED [ 15%]
tests/unit/core/test_session_comprehensive.py::TestExtendSession::test_extend_session_logs_info PASSED [ 16%]
tests/unit/core/test_session_comprehensive.py::TestValidateSession::test_validate_session_valid PASSED [ 16%]
tests/unit/core/test_session_comprehensive.py::TestValidateSession::test_validate_session_not_found PASSED [ 16%]
tests/unit/core/test_session_comprehensive.py::TestValidateSession::test_validate_session_ip_check_enabled PASSED [ 16%]
tests/unit/core/test_session_comprehensive.py::TestValidateSession::test_validate_session_rotation_recommendation PASSED [ 16%]
tests/unit/core/test_session_comprehensive.py::TestValidateSession::test_validate_session_recent_no_rotation PASSED [ 16%]
tests/unit/core/test_session_comprehensive.py::TestCleanupExpiredSessions::test_cleanup_expired_sessions PASSED [ 16%]
tests/unit/core/test_session_comprehensive.py::TestSessionManagerSingleton::test_get_session_manager_singleton PASSED [ 16%]
tests/unit/core/test_session_comprehensive.py::TestSessionManagerSingleton::test_get_session_manager_creates_instance PASSED [ 16%]
tests/unit/core/test_session_comprehensive.py::TestSessionConstants::test_session_constants_defined PASSED [ 16%]
tests/unit/core/test_session_comprehensive.py::TestSessionSecurityScenarios::test_session_id_entropy PASSED [ 16%]
tests/unit/core/test_session_comprehensive.py::TestSessionSecurityScenarios::test_session_fixation_prevention PASSED [ 16%]
tests/unit/core/test_session_comprehensive.py::TestSessionSecurityScenarios::test_concurrent_session_operations PASSED [ 16%]
tests/unit/core/test_sql_injection_prevention.py::TestSQLInjectionDetection::test_detect_basic_injection_patterns PASSED [ 16%]
tests/unit/core/test_sql_injection_prevention.py::TestSQLInjectionDetection::test_detect_advanced_injection_patterns PASSED [ 16%]
tests/unit/core/test_sql_injection_prevention.py::TestSQLInjectionDetection::test_severity_threshold PASSED [ 16%]
tests/unit/core/test_sql_injection_prevention.py::TestSQLInjectionDetection::test_no_false_positives PASSED [ 16%]
tests/unit/core/test_sql_injection_prevention.py::TestQueryParameterValidation::test_valid_parameter_names PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestQueryParameterValidation::test_invalid_parameter_names PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestQueryParameterValidation::test_parameter_type_validation PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestQueryParameterValidation::test_parameter_length_validation PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestQueryParameterValidation::test_sql_injection_in_parameters PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestSafeQueryBuilder::test_build_basic_safe_query PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestSafeQueryBuilder::test_strict_validation_blocks_dangerous_queries PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestSafeQueryBuilder::test_table_whitelist_validation PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestSafeQueryBuilder::test_column_whitelist_validation PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestSafeQueryBuilder::test_parameterized_query_validation PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestQueryBuilder::test_basic_query_building PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestQueryBuilder::test_multiple_where_conditions PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestQueryBuilder::test_order_by_validation PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestQueryBuilder::test_pagination PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestQueryBuilder::test_sql_injection_prevention_in_builder PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestSQLInjectionPreventionMiddleware::test_middleware_initialization PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestSQLInjectionPreventionMiddleware::test_check_single_value PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestSQLInjectionPreventionMiddleware::test_check_request_data PASSED [ 17%]
tests/unit/core/test_sql_injection_prevention.py::TestSQLInjectionPreventionMiddleware::test_nested_data_checking PASSED [ 18%]
tests/unit/core/test_sql_injection_prevention.py::TestPreDefinedTemplates::test_get_existing_template PASSED [ 18%]
tests/unit/core/test_sql_injection_prevention.py::TestPreDefinedTemplates::test_get_nonexistent_template PASSED [ 18%]
tests/unit/core/test_sql_injection_prevention.py::TestPreDefinedTemplates::test_template_immutability PASSED [ 18%]
tests/unit/core/test_sql_injection_prevention.py::TestIntegrationScenarios::test_user_search_scenario PASSED [ 18%]
tests/unit/core/test_sql_injection_prevention.py::TestIntegrationScenarios::test_report_generation_scenario PASSED [ 18%]
tests/unit/core/test_sql_injection_prevention.py::TestIntegrationScenarios::test_complex_join_scenario PASSED [ 18%]
tests/unit/db/test_database_session_comprehensive.py::TestCreateDatabaseEngine::test_create_engine_no_url PASSED [ 18%]
tests/unit/db/test_database_session_comprehensive.py::TestCreateDatabaseEngine::test_create_engine_sqlite PASSED [ 18%]
tests/unit/db/test_database_session_comprehensive.py::TestCreateDatabaseEngine::test_create_engine_postgresql PASSED [ 18%]
tests/unit/db/test_database_session_comprehensive.py::TestCreateDatabaseEngine::test_create_engine_debug_mode PASSED [ 18%]
tests/unit/db/test_database_session_comprehensive.py::TestCreateDatabaseEngine::test_create_engine_exception PASSED [ 18%]
tests/unit/db/test_database_session_comprehensive.py::TestGetSessionMaker::test_get_session_maker_new PASSED [ 18%]
tests/unit/db/test_database_session_comprehensive.py::TestGetSessionMaker::test_get_session_maker_existing PASSED [ 18%]
tests/unit/db/test_database_session_comprehensive.py::TestGetSessionMaker::test_get_session_maker_no_engine PASSED [ 18%]
tests/unit/db/test_database_session_comprehensive.py::TestGetDB::test_get_db_success PASSED [ 18%]
tests/unit/db/test_database_session_comprehensive.py::TestGetDB::test_get_db_sqlalchemy_error PASSED [ 18%]
tests/unit/db/test_database_session_comprehensive.py::TestGetDB::test_get_db_general_error PASSED [ 18%]
tests/unit/db/test_database_session_comprehensive.py::TestGetDB::test_get_db_no_session_maker PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestCheckDatabaseHealth::test_health_check_no_url PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestCheckDatabaseHealth::test_health_check_success PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestCheckDatabaseHealth::test_health_check_timeout PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestCheckDatabaseHealth::test_health_check_circuit_breaker_open PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestCheckDatabaseHealth::test_health_check_unexpected_result PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestCheckDatabaseHealth::test_health_check_sqlalchemy_error PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestConnectionPoolStats::test_get_stats_with_engine PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestConnectionPoolStats::test_get_stats_no_engine PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestConnectionPoolStats::test_get_stats_null_pool PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestConnectionPoolStats::test_get_stats_exception PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestCloseConnections::test_close_connections_success PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestCloseConnections::test_close_connections_no_engine PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestCloseConnections::test_close_connections_error PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestValidateConnection::test_validate_connection_healthy PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestValidateConnection::test_validate_connection_recovery_success PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestValidateConnection::test_validate_connection_recovery_failed PASSED [ 19%]
tests/unit/db/test_database_session_comprehensive.py::TestValidateConnection::test_validate_connection_exception PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestCircuitBreakerIntegration::test_is_database_available_no_url PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestCircuitBreakerIntegration::test_is_database_available_circuit_open PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestCircuitBreakerIntegration::test_is_database_available_ok PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestCircuitBreakerIntegration::test_reset_circuit_breaker_success PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestCircuitBreakerIntegration::test_reset_circuit_breaker_still_unhealthy PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestCircuitBreakerIntegration::test_reset_circuit_breaker_exception PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestInitDatabase::test_init_database_no_url PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestInitDatabase::test_init_database_success PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestInitDatabase::test_init_database_no_session_maker PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestInitDatabase::test_init_database_health_check_failed PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestRecoverConnection::test_recover_connection_first_attempt PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestRecoverConnection::test_recover_connection_circuit_reset PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestRecoverConnection::test_recover_connection_multiple_attempts PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestRecoverConnection::test_recover_connection_all_attempts_failed PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestRecoverConnection::test_recover_connection_with_exceptions PASSED [ 20%]
tests/unit/db/test_database_session_comprehensive.py::TestCreateAsyncSessionMaker::test_create_async_session_maker PASSED [ 20%]
tests/unit/db/test_db_session_comprehensive.py::TestDatabaseEngineCreation::test_get_engine_postgresql PASSED [ 20%]
tests/unit/db/test_db_session_comprehensive.py::TestDatabaseEngineCreation::test_get_engine_sqlite PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestDatabaseEngineCreation::test_get_engine_singleton PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestDatabaseSessionMaker::test_get_session_maker PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestDatabaseSessionMaker::test_get_session_maker_singleton PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestGetDbWithCircuitBreaker::test_get_db_success PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestGetDbWithCircuitBreaker::test_get_db_with_exception PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestGetDbWithCircuitBreaker::test_get_db_circuit_breaker_open PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestGetDbWithCircuitBreaker::test_get_db_session_creation_failure PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestDatabaseHealthCheck::test_check_database_health_success PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestDatabaseHealthCheck::test_check_database_health_failure PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestDatabaseHealthCheck::test_check_database_health_timeout PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestDatabaseHealthCheck::test_check_database_health_circuit_breaker_open PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestConnectionPoolStats::test_get_connection_pool_stats_with_pool PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestConnectionPoolStats::test_get_connection_pool_stats_null_pool PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestConnectionPoolStats::test_get_connection_pool_stats_error PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestDatabaseShutdownAndRecovery::test_close_database_connections_success PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestDatabaseShutdownAndRecovery::test_close_database_connections_with_error PASSED [ 21%]
tests/unit/db/test_db_session_comprehensive.py::TestDatabaseShutdownAndRecovery::test_close_database_connections_no_engine PASSED [ 22%]
tests/unit/db/test_db_session_comprehensive.py::TestDatabaseShutdownAndRecovery::test_recreate_database_pool_success PASSED [ 22%]
tests/unit/db/test_db_session_comprehensive.py::TestDatabaseShutdownAndRecovery::test_recreate_database_pool_engine_creation_fails PASSED [ 22%]
tests/unit/db/test_db_session_comprehensive.py::TestDatabaseShutdownAndRecovery::test_recreate_database_pool_exception PASSED [ 22%]
tests/unit/db/test_db_session_comprehensive.py::TestCircuitBreakerReset::test_reset_circuit_breaker_success PASSED [ 22%]
tests/unit/db/test_db_session_comprehensive.py::TestCircuitBreakerReset::test_reset_circuit_breaker_health_check_fails PASSED [ 22%]
tests/unit/db/test_db_session_comprehensive.py::TestCircuitBreakerReset::test_reset_circuit_breaker_exception PASSED [ 22%]
tests/unit/db/test_types_comprehensive.py::TestGUIDType::test_guid_load_dialect_impl_postgresql PASSED [ 22%]
tests/unit/db/test_types_comprehensive.py::TestGUIDType::test_guid_load_dialect_impl_sqlite PASSED [ 22%]
tests/unit/db/test_types_comprehensive.py::TestGUIDType::test_guid_load_dialect_impl_other PASSED [ 22%]
tests/unit/db/test_types_comprehensive.py::TestGUIDType::test_guid_process_bind_param_uuid_postgresql PASSED [ 22%]
tests/unit/db/test_types_comprehensive.py::TestGUIDType::test_guid_process_bind_param_string_postgresql PASSED [ 22%]
tests/unit/db/test_types_comprehensive.py::TestGUIDType::test_guid_process_bind_param_invalid_postgresql PASSED [ 22%]
tests/unit/db/test_types_comprehensive.py::TestGUIDType::test_guid_process_bind_param_sqlite PASSED [ 22%]
tests/unit/db/test_types_comprehensive.py::TestGUIDType::test_guid_process_bind_param_none PASSED [ 22%]
tests/unit/db/test_types_comprehensive.py::TestGUIDType::test_guid_process_result_value_uuid PASSED [ 22%]
tests/unit/db/test_types_comprehensive.py::TestGUIDType::test_guid_process_result_value_string PASSED [ 22%]
tests/unit/db/test_types_comprehensive.py::TestGUIDType::test_guid_process_result_value_none PASSED [ 22%]
tests/unit/db/test_types_comprehensive.py::TestGUIDType::test_guid_process_result_value_empty_string PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestGUIDType::test_guid_cache_ok PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_load_dialect_impl_postgresql PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_load_dialect_impl_sqlite PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_load_dialect_impl_other PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_bind_param_dict PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_bind_param_list PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_bind_param_nested PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_bind_param_none PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_bind_param_empty_dict PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_bind_param_empty_list PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_bind_param_unicode PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_bind_param_special_chars PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_bind_param_non_serializable PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_bind_param_circular_reference PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_result_value_dict_string PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_result_value_list_string PASSED [ 23%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_result_value_postgresql_dict PASSED [ 24%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_result_value_none PASSED [ 24%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_result_value_empty_string PASSED [ 24%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_result_value_invalid_json PASSED [ 24%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_result_value_whitespace_only PASSED [ 24%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_process_result_value_numbers PASSED [ 24%]
tests/unit/db/test_types_comprehensive.py::TestJSONType::test_json_cache_ok PASSED [ 24%]
tests/unit/db/test_types_comprehensive.py::TestTypesIntegration::test_guid_roundtrip_sqlite PASSED [ 24%]
tests/unit/db/test_types_comprehensive.py::TestTypesIntegration::test_json_roundtrip_sqlite PASSED [ 24%]
tests/unit/db/test_types_comprehensive.py::TestTypesIntegration::test_json_null_roundtrip_sqlite PASSED [ 24%]
tests/unit/db/test_unit_db_session.py::TestDatabaseEngine::test_create_database_engine_no_url PASSED [ 24%]
tests/unit/db/test_unit_db_session.py::TestDatabaseEngine::test_create_database_engine_success PASSED [ 24%]
tests/unit/db/test_unit_db_session.py::TestDatabaseEngine::test_create_database_engine_exception PASSED [ 24%]
tests/unit/db/test_unit_db_session.py::TestSessionMaker::test_get_session_maker_no_engine PASSED [ 24%]
tests/unit/db/test_unit_db_session.py::TestSessionMaker::test_get_session_maker_success PASSED [ 24%]
tests/unit/db/test_unit_db_session.py::TestSessionMaker::test_get_session_maker_cached PASSED [ 24%]
tests/unit/db/test_unit_db_session.py::TestDatabaseContext::test_get_db_no_session_maker PASSED [ 24%]
tests/unit/db/test_unit_db_session.py::TestDatabaseContext::test_get_db_success PASSED [ 24%]
tests/unit/db/test_unit_db_session.py::TestDatabaseContext::test_get_db_exception_rollback PASSED [ 25%]
tests/unit/db/test_unit_db_session.py::TestDatabaseHealth::test_check_database_health_no_url PASSED [ 25%]
tests/unit/db/test_unit_db_session.py::TestDatabaseHealth::test_check_database_health_success PASSED [ 25%]
tests/unit/db/test_unit_db_session.py::TestDatabaseHealth::test_check_database_health_wrong_result PASSED [ 25%]
tests/unit/db/test_unit_db_session.py::TestDatabaseHealth::test_check_database_health_timeout PASSED [ 25%]
tests/unit/db/test_unit_db_session.py::TestDatabaseHealth::test_check_database_health_exception PASSED [ 25%]
tests/unit/db/test_unit_db_session.py::TestDatabaseShutdown::test_close_database_connections_no_engine PASSED [ 25%]
tests/unit/db/test_unit_db_session.py::TestDatabaseShutdown::test_close_database_connections_success PASSED [ 25%]
tests/unit/db/test_unit_db_session.py::TestDatabaseShutdown::test_close_database_connections_resets_global PASSED [ 25%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_exempt_paths_bypass_authentication PASSED [ 25%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_exempt_path_prefix_matching PASSED [ 25%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_protected_paths_require_authentication PASSED [ 25%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_protected_methods_always_require_auth PASSED [ 25%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_unprotected_paths_allow_anonymous_access PASSED [ 25%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_valid_bearer_token_accepted PASSED [ 25%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_missing_authorization_header_rejected PASSED [ 25%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_malformed_authorization_header_rejected PASSED [ 25%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_invalid_jwt_token_rejected PASSED [ 25%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_expired_jwt_token_rejected PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_wrong_token_type_rejected PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_enhanced_jwt_claims_validation PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_user_id_injection_into_request_state PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_token_payload_injection_into_request_state PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_request_state_isolation_between_concurrent_requests PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_standardized_401_response_format PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_www_authenticate_header_presence PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_no_information_disclosure_in_errors PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_jwt_decode_error_handling PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_unexpected_exception_handling PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_middleware_integration_with_other_middleware PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_large_jwt_token_handling PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_unicode_and_special_characters_in_tokens PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestJWTAuthenticationMiddleware::test_path_matching_edge_cases PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestUtilityFunctions::test_get_current_user_id_with_authenticated_request PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestUtilityFunctions::test_get_current_user_id_with_unauthenticated_request PASSED [ 26%]
tests/unit/middleware/test_authentication_middleware.py::TestUtilityFunctions::test_get_current_token_payload_with_authenticated_request PASSED [ 27%]
tests/unit/middleware/test_authentication_middleware.py::TestUtilityFunctions::test_get_current_token_payload_with_unauthenticated_request PASSED [ 27%]
tests/unit/middleware/test_authentication_middleware.py::TestUtilityFunctions::test_require_auth_decorator PASSED [ 27%]
tests/unit/middleware/test_authentication_middleware.py::TestMiddlewareConfiguration::test_protected_paths_configuration PASSED [ 27%]
tests/unit/middleware/test_authentication_middleware.py::TestMiddlewareConfiguration::test_exempt_paths_configuration PASSED [ 27%]
tests/unit/middleware/test_authentication_middleware.py::TestMiddlewareConfiguration::test_protected_methods_configuration PASSED [ 27%]
tests/unit/middleware/test_authentication_middleware.py::TestMiddlewareConfiguration::test_middleware_initialization PASSED [ 27%]
tests/unit/middleware/test_authentication_middleware.py::TestSecurityLogging::test_missing_token_logged PASSED [ 27%]
tests/unit/middleware/test_authentication_middleware.py::TestSecurityLogging::test_invalid_token_type_logged PASSED [ 27%]
tests/unit/middleware/test_authentication_middleware.py::TestSecurityLogging::test_successful_authentication_logged PASSED [ 27%]
tests/unit/middleware/test_csrf_advanced_security.py::TestConcurrentRequestHandling::test_multiple_requests_same_token PASSED [ 27%]
tests/unit/middleware/test_csrf_advanced_security.py::TestConcurrentRequestHandling::test_race_condition_token_validation PASSED [ 27%]
tests/unit/middleware/test_csrf_advanced_security.py::TestConcurrentRequestHandling::test_async_concurrent_validation PASSED [ 27%]
tests/unit/middleware/test_csrf_advanced_security.py::TestTokenLifecycleManagement::test_token_expiration_handling PASSED [ 27%]
tests/unit/middleware/test_csrf_advanced_security.py::TestTokenLifecycleManagement::test_token_rotation_during_session PASSED [ 27%]
tests/unit/middleware/test_csrf_advanced_security.py::TestTokenLifecycleManagement::test_token_reuse_after_logout PASSED [ 27%]
tests/unit/middleware/test_csrf_advanced_security.py::TestTokenLifecycleManagement::test_token_persistence_across_requests PASSED [ 27%]
tests/unit/middleware/test_csrf_advanced_security.py::TestCrossOriginAttackVectors::test_cross_origin_request_blocked PASSED [ 27%]
tests/unit/middleware/test_csrf_advanced_security.py::TestCrossOriginAttackVectors::test_subdomain_token_leakage PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestCrossOriginAttackVectors::test_referrer_validation PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestCrossOriginAttackVectors::test_origin_header_spoofing PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestTokenStorageSecurity::test_cookie_security_attributes PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestTokenStorageSecurity::test_token_persistence_server_restart PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestTokenStorageSecurity::test_token_storage_in_different_modes PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestTokenStorageSecurity::test_token_entropy PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestAdvancedAttackScenarios::test_token_fixation_attack PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestAdvancedAttackScenarios::test_token_prediction_attack PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestAdvancedAttackScenarios::test_timing_attack_resistance PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestAdvancedAttackScenarios::test_double_submit_cookie_mismatch PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestEdgeCasesAndErrorHandling::test_malformed_token_handling PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestEdgeCasesAndErrorHandling::test_missing_middleware_config PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestEdgeCasesAndErrorHandling::test_unicode_and_encoding_issues PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestPerformanceAndScalability::test_token_generation_performance PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestPerformanceAndScalability::test_token_validation_performance PASSED [ 28%]
tests/unit/middleware/test_csrf_advanced_security.py::TestPerformanceAndScalability::test_concurrent_token_generation PASSED [ 28%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_safe_method_allowed PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_unsafe_method_without_token_rejected PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_unsafe_method_with_invalid_token_rejected PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_csrf_token_generation_and_validation PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_form_csrf_token_validation PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_double_submit_cookie_pattern PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_csrf_disabled PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_exempt_paths PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_csrf_token_signature_validation PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_csrf_token_parts PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_unsafe_methods_require_csrf[POST] PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_unsafe_methods_require_csrf[PUT] PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_unsafe_methods_require_csrf[PATCH] PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_unsafe_methods_require_csrf[DELETE] PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_csrf_cookie_attributes PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_content_type_form_handling PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware.py::TestCSRFProtectionMiddleware::test_csrf_error_logging PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFMiddlewareInitialization::test_middleware_initialization PASSED [ 29%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFMiddlewareInitialization::test_middleware_uses_settings_secret PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFTokenGeneration::test_generate_csrf_token_format PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFTokenGeneration::test_generate_csrf_token_uniqueness PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFTokenGeneration::test_generate_csrf_token_signature_valid PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFTokenGeneration::test_generate_csrf_token_length PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFTokenValidation::test_validate_csrf_token_valid_tokens PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFTokenValidation::test_validate_csrf_token_missing_cookie PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFTokenValidation::test_validate_csrf_token_missing_submitted PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFTokenValidation::test_validate_csrf_token_both_missing PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFTokenValidation::test_validate_csrf_token_different_tokens PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFTokenValidation::test_validate_csrf_token_invalid_format PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFTokenValidation::test_validate_csrf_token_tampered_signature PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFTokenValidation::test_validate_csrf_token_constant_time_comparison PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFTokenValidation::test_validate_csrf_token_exception_handling PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFTokenValidation::test_validate_csrf_token_logs_error PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFCookieHandling::test_set_csrf_cookie_basic PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFCookieHandling::test_set_csrf_cookie_secure_settings PASSED [ 30%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFCookieHandling::test_set_csrf_cookie_logs_debug PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFMiddlewareDispatch::test_dispatch_safe_methods_allowed PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFMiddlewareDispatch::test_dispatch_exempt_paths_allowed PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFMiddlewareDispatch::test_dispatch_csrf_disabled_allowed PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFMiddlewareDispatch::test_dispatch_missing_tokens_blocked PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFMiddlewareDispatch::test_dispatch_invalid_tokens_blocked PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFMiddlewareDispatch::test_dispatch_valid_tokens_allowed PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFMiddlewareDispatch::test_dispatch_form_token_parsing PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFMiddlewareDispatch::test_dispatch_form_parsing_exception PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFMiddlewareDispatch::test_dispatch_token_generation_for_new_requests PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFMiddlewareDispatch::test_dispatch_existing_cookie_token PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFMiddlewareDispatch::test_dispatch_sets_csrf_cookie_on_response PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFMiddlewareDispatch::test_dispatch_logs_validation_failure PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFUtilityFunctions::test_get_csrf_token_exists PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFUtilityFunctions::test_get_csrf_token_missing PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFUtilityFunctions::test_exempt_from_csrf_decorator PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFUtilityFunctions::test_exempt_from_csrf_decorator_preserves_function PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFConstants::test_csrf_constants_defined PASSED [ 31%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFConstants::test_safe_methods_complete PASSED [ 32%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFConstants::test_exempt_paths_cover_essential_endpoints PASSED [ 32%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFIntegrationScenarios::test_csrf_protection_enabled_integration PASSED [ 32%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFIntegrationScenarios::test_csrf_protection_disabled_integration PASSED [ 32%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFIntegrationScenarios::test_csrf_with_valid_tokens_integration PASSED [ 32%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFIntegrationScenarios::test_csrf_exempt_path_integration PASSED [ 32%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFIntegrationScenarios::test_csrf_form_data_integration PASSED [ 32%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFEdgeCases::test_dispatch_partial_path_match PASSED [ 32%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFEdgeCases::test_dispatch_case_sensitive_methods PASSED [ 32%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFEdgeCases::test_validate_csrf_token_empty_strings PASSED [ 32%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFEdgeCases::test_validate_csrf_token_whitespace PASSED [ 32%]
tests/unit/middleware/test_csrf_middleware_comprehensive.py::TestCSRFEdgeCases::test_dispatch_no_content_type_header PASSED [ 32%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_complete_claims_structure_validation PASSED [ 32%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_subject_claim_processing PASSED [ 32%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_roles_array_processing_for_rbac PASSED [ 32%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_organization_id_processing_for_abac PASSED [ 32%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_token_type_validation PASSED [ 32%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_claims_injection_attack_prevention PASSED [ 32%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_claims_tampering_detection PASSED [ 33%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_missing_required_claims_handling PASSED [ 33%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_roles_array_type_validation PASSED [ 33%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_organization_id_string_validation PASSED [ 33%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_subject_claim_string_validation PASSED [ 33%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_organization_isolation_context PASSED [ 33%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_cross_organization_token_boundaries PASSED [ 33%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_rbac_role_hierarchies_in_claims PASSED [ 33%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_rbac_role_validation_patterns PASSED [ 33%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_abac_attribute_context_preservation PASSED [ 33%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_large_roles_array_processing PASSED [ 33%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_complex_organization_identifiers PASSED [ 33%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_backwards_compatibility_with_legacy_claims PASSED [ 33%]
tests/unit/middleware/test_enhanced_jwt_claims.py::TestEnhancedJWTClaims::test_enhanced_claims_with_additional_custom_fields PASSED [ 33%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestUnicodeAttacks::test_utf8_overlong_encoding PASSED [ 33%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestUnicodeAttacks::test_unicode_homograph_attacks PASSED [ 33%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestUnicodeAttacks::test_unicode_normalization_attacks PASSED [ 33%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestUnicodeAttacks::test_bidi_override_attacks PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestPolyglotPayloads::test_javascript_html_polyglot PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestPolyglotPayloads::test_sql_xss_polyglot PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestPolyglotPayloads::test_multiencoding_polyglot PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestDOMXSSPatterns::test_json_response_dom_xss PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestDOMXSSPatterns::test_json_callback_injection PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestDOMXSSPatterns::test_angular_template_injection PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestMutationXSS::test_browser_mutation_patterns PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestMutationXSS::test_namespace_confusion PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestNestedDataStructures::test_deeply_nested_json PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestNestedDataStructures::test_recursive_depth_limit PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestNestedDataStructures::test_mixed_nested_attacks PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestPerformanceAndDoS::test_large_payload_performance PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestPerformanceAndDoS::test_algorithmic_complexity_attack PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestPerformanceAndDoS::test_memory_exhaustion_patterns PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestPerformanceAndDoS::test_payload_size_limits PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestEncodingAttacks::test_double_url_encoding PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestEncodingAttacks::test_mixed_encoding_types PASSED [ 34%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestEncodingAttacks::test_charset_confusion PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestEncodingAttacks::test_null_byte_injection PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestEdgeCasesAndSpecialScenarios::test_empty_and_whitespace_payloads PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestEdgeCasesAndSpecialScenarios::test_content_type_boundary_cases PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestEdgeCasesAndSpecialScenarios::test_header_injection_attempts PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_advanced.py::TestEdgeCasesAndSpecialScenarios::test_unicode_case_variations PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_clean_query_params PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_malicious_query_params PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_sql_injection_query_params PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_clean_json_body PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_malicious_json_body PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_nested_json_sanitization PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_form_data_sanitization PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_malicious_form_data PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_large_request_body_rejected PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_invalid_json_rejected PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_exempt_paths_bypass_sanitization PASSED [ 35%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_url_decoding PASSED [ 36%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_header_sanitization PASSED [ 36%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_whitelisted_headers_preserved PASSED [ 36%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_content_type_handling PASSED [ 36%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_sanitization_error_handling PASSED [ 36%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_various_malicious_inputs[<script>alert('xss')</script>-<lambda>] PASSED [ 36%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_various_malicious_inputs[javascript:alert('xss')-<lambda>] PASSED [ 36%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_various_malicious_inputs[<iframe src='evil.com'></iframe>-<lambda>] PASSED [ 36%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_various_malicious_inputs['; DROP TABLE users; ---<lambda>] PASSED [ 36%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_various_malicious_inputs[1' OR '1'='1-<lambda>] PASSED [ 36%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_various_malicious_inputs[<img onerror='alert(1)' src='x'>-<lambda>] PASSED [ 36%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_empty_request_body PASSED [ 36%]
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_multipart_form_data PASSED [ 36%]
tests/unit/middleware/test_logging_middleware.py::TestLoggingMiddleware::test_request_logged PASSED [ 36%]
tests/unit/middleware/test_logging_middleware.py::TestLoggingMiddleware::test_response_logged PASSED [ 36%]
tests/unit/middleware/test_logging_middleware.py::TestLoggingMiddleware::test_health_endpoints_not_logged PASSED [ 36%]
tests/unit/middleware/test_logging_middleware.py::TestLoggingMiddleware::test_query_params_logged PASSED [ 36%]
tests/unit/middleware/test_logging_middleware.py::TestLoggingMiddleware::test_post_request_logged PASSED [ 36%]
tests/unit/middleware/test_logging_middleware.py::TestLoggingMiddleware::test_response_time_header PASSED [ 37%]
tests/unit/middleware/test_logging_middleware.py::TestLoggingMiddleware::test_slow_request_timing PASSED [ 37%]
tests/unit/middleware/test_logging_middleware.py::TestLoggingMiddleware::test_error_request_logged PASSED [ 37%]
tests/unit/middleware/test_logging_middleware.py::TestLoggingMiddleware::test_http_exception_logged PASSED [ 37%]
tests/unit/middleware/test_logging_middleware.py::TestLoggingMiddleware::test_multiple_requests_logged_separately PASSED [ 37%]
tests/unit/middleware/test_logging_middleware.py::TestLoggingMiddleware::test_empty_content_length PASSED [ 37%]
tests/unit/middleware/test_logging_middleware.py::TestLoggingMiddleware::test_log_levels PASSED [ 37%]
tests/unit/middleware/test_logging_middleware.py::TestLoggingMiddleware::test_concurrent_requests PASSED [ 37%]
tests/unit/middleware/test_logging_middleware.py::TestLoggingMiddleware::test_unicode_handling PASSED [ 37%]
tests/unit/middleware/test_metrics_middleware.py::TestMetricsMiddleware::test_metrics_enabled_check PASSED [ 37%]
tests/unit/middleware/test_metrics_middleware.py::TestMetricsMiddleware::test_request_count_metric PASSED [ 37%]
tests/unit/middleware/test_metrics_middleware.py::TestMetricsMiddleware::test_request_duration_metric PASSED [ 37%]
tests/unit/middleware/test_metrics_middleware.py::TestMetricsMiddleware::test_active_requests_metric PASSED [ 37%]
tests/unit/middleware/test_metrics_middleware.py::TestMetricsMiddleware::test_endpoint_normalization PASSED [ 37%]
tests/unit/middleware/test_metrics_middleware.py::TestMetricsMiddleware::test_metrics_endpoint_excluded PASSED [ 37%]
tests/unit/middleware/test_metrics_middleware.py::TestMetricsMiddleware::test_error_requests_tracked PASSED [ 37%]
tests/unit/middleware/test_metrics_middleware.py::TestMetricsMiddleware::test_http_exception_tracked PASSED [ 37%]
tests/unit/middleware/test_metrics_middleware.py::TestMetricsMiddleware::test_different_methods_tracked PASSED [ 37%]
tests/unit/middleware/test_metrics_middleware.py::TestMetricsMiddleware::test_slow_request_duration PASSED [ 38%]
tests/unit/middleware/test_metrics_middleware.py::TestMetricsMiddleware::test_concurrent_request_metrics PASSED [ 38%]
tests/unit/middleware/test_metrics_middleware.py::TestMetricsMiddleware::test_path_parameter_variations PASSED [ 38%]
tests/unit/middleware/test_metrics_middleware.py::TestMetricsMiddleware::test_metric_labels PASSED [ 38%]
tests/unit/middleware/test_permission_middleware.py::TestPermissionMiddleware::test_permission_checker_public_endpoint PASSED [ 38%]
tests/unit/middleware/test_permission_middleware.py::TestPermissionMiddleware::test_permission_checker_no_user PASSED [ 38%]
tests/unit/middleware/test_permission_middleware.py::TestPermissionMiddleware::test_permission_checker_superuser_bypass PASSED [ 38%]
tests/unit/middleware/test_permission_middleware.py::TestPermissionMiddleware::test_permission_checker_with_valid_permission PASSED [ 38%]
tests/unit/middleware/test_permission_middleware.py::TestPermissionMiddleware::test_permission_checker_insufficient_permission PASSED [ 38%]
tests/unit/middleware/test_permission_middleware.py::TestPermissionMiddleware::test_permission_checker_ownership_check_own_resource PASSED [ 38%]
tests/unit/middleware/test_permission_middleware.py::TestPermissionMiddleware::test_permission_checker_ownership_check_other_resource PASSED [ 38%]
tests/unit/middleware/test_permission_middleware.py::TestPermissionMiddleware::test_get_current_user_permissions PASSED [ 38%]
tests/unit/middleware/test_permission_middleware.py::TestPermissionMiddleware::test_require_permission_decorator_allowed PASSED [ 38%]
tests/unit/middleware/test_permission_middleware.py::TestPermissionMiddleware::test_require_permission_decorator_denied PASSED [ 38%]
tests/unit/middleware/test_permission_middleware.py::TestPermissionMiddleware::test_require_any_permission_decorator_allowed PASSED [ 38%]
tests/unit/middleware/test_permission_middleware.py::TestPermissionMiddleware::test_require_any_permission_decorator_denied PASSED [ 38%]
tests/unit/middleware/test_permission_middleware.py::TestPermissionMiddleware::test_permission_checker_wildcard_permissions PASSED [ 38%]
tests/unit/middleware/test_permission_middleware.py::TestPermissionMiddleware::test_permission_checker_api_key_endpoints PASSED [ 39%]
tests/unit/middleware/test_permission_middleware.py::TestPermissionMiddleware::test_permission_checker_custom_resource_mapping PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddleware::test_middleware_disabled PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddleware::test_get_endpoint_type_auth_login PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddleware::test_get_endpoint_type_auth_register PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddleware::test_get_endpoint_type_user_create PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddleware::test_get_endpoint_type_user_read PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddleware::test_get_endpoint_type_user_list PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddleware::test_get_endpoint_type_health_check PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddleware::test_get_endpoint_type_unknown_defaults_to_default PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddleware::test_parse_rate_limit_count PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddleware::test_parse_rate_limit_expire PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddleware::test_middleware_adds_rate_limit_headers PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddleware::test_middleware_handles_exceptions_gracefully PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddleware::test_endpoint_pattern_matching PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddleware::test_rate_limit_check_logs_debug_info PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddleware::test_create_rate_limit_response PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddlewareIntegration::test_middleware_full_flow_without_rate_limiting PASSED [ 39%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddlewareIntegration::test_middleware_identifies_all_auth_endpoints PASSED [ 40%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddlewareIntegration::test_middleware_processes_request_with_rate_limiting_enabled PASSED [ 40%]
tests/unit/middleware/test_rate_limiting_middleware.py::TestRateLimitingMiddlewareIntegration::test_middleware_with_different_rate_limits PASSED [ 40%]
tests/unit/middleware/test_request_id_middleware.py::TestRequestIDMiddleware::test_request_id_generated PASSED [ 40%]
tests/unit/middleware/test_request_id_middleware.py::TestRequestIDMiddleware::test_custom_request_id_preserved PASSED [ 40%]
tests/unit/middleware/test_request_id_middleware.py::TestRequestIDMiddleware::test_unique_request_ids PASSED [ 40%]
tests/unit/middleware/test_request_id_middleware.py::TestRequestIDMiddleware::test_request_timing_logged PASSED [ 40%]
tests/unit/middleware/test_request_id_middleware.py::TestRequestIDMiddleware::test_slow_request_timing PASSED [ 40%]
tests/unit/middleware/test_request_id_middleware.py::TestRequestIDMiddleware::test_error_request_logged PASSED [ 40%]
tests/unit/middleware/test_request_id_middleware.py::TestRequestIDMiddleware::test_client_ip_extraction PASSED [ 40%]
tests/unit/middleware/test_request_id_middleware.py::TestRequestIDMiddleware::test_logging_context_set PASSED [ 40%]
tests/unit/middleware/test_request_id_middleware.py::TestRequestIDMiddleware::test_logging_context_cleared PASSED [ 40%]
tests/unit/middleware/test_request_id_middleware.py::TestRequestIDMiddleware::test_concurrent_requests_isolated PASSED [ 40%]
tests/unit/middleware/test_request_id_middleware.py::TestRequestIDMiddleware::test_request_state_accessible PASSED [ 40%]
tests/unit/middleware/test_request_id_middleware.py::TestRequestIDMiddleware::test_different_http_methods PASSED [ 40%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigningMiddleware::test_public_endpoint_no_signing_required PASSED [ 40%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigningMiddleware::test_protected_endpoint_requires_signing PASSED [ 40%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigningMiddleware::test_missing_signature_headers PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigningMiddleware::test_expired_timestamp PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigningMiddleware::test_invalid_timestamp_format PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigningMiddleware::test_nonce_replay_detection PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigningMiddleware::test_invalid_api_key PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigningMiddleware::test_valid_signature_accepted PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigningMiddleware::test_invalid_signature_rejected PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigningMiddleware::test_nonce_storage_after_validation PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigner::test_request_signer_initialization PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigner::test_sign_request_basic PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigner::test_sign_request_with_body PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigner::test_sign_request_with_query_params PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigner::test_canonical_request_creation PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigner::test_signature_consistency PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigner::test_different_requests_different_signatures PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigner::test_api_key_lookup[test_api_key-test_secret] PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigner::test_api_key_lookup[admin_api_key-admin_secret] PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigner::test_api_key_lookup[invalid_key-None] PASSED [ 41%]
tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigner::test_signature_verification PASSED [ 42%]
tests/unit/middleware/test_request_size.py::test_request_within_limit PASSED [ 42%]
tests/unit/middleware/test_request_size.py::test_request_exceeds_limit PASSED [ 42%]
tests/unit/middleware/test_request_size.py::test_upload_within_limit PASSED [ 42%]
tests/unit/middleware/test_request_size.py::test_upload_exceeds_limit PASSED [ 42%]
tests/unit/middleware/test_request_size.py::test_get_request_not_limited PASSED [ 42%]
tests/unit/middleware/test_request_size.py::test_response_headers PASSED [ 42%]
tests/unit/middleware/test_request_size.py::test_missing_content_length_header PASSED [ 42%]
tests/unit/middleware/test_request_size.py::test_invalid_content_length_header PASSED [ 42%]
tests/unit/middleware/test_request_size.py::TestRequestSizeLimitMiddleware::test_is_upload_endpoint PASSED [ 42%]
tests/unit/middleware/test_request_size.py::TestRequestSizeLimitMiddleware::test_get_content_length PASSED [ 42%]
tests/unit/middleware/test_request_size.py::test_large_request_warning PASSED [ 42%]
tests/unit/middleware/test_security_middleware.py::TestSecurityHeadersMiddleware::test_security_headers_present PASSED [ 42%]
tests/unit/middleware/test_security_middleware.py::TestSecurityHeadersMiddleware::test_hsts_header PASSED [ 42%]
tests/unit/middleware/test_security_middleware.py::TestSecurityHeadersMiddleware::test_csp_header PASSED [ 42%]
tests/unit/middleware/test_security_middleware.py::TestSecurityHeadersMiddleware::test_x_frame_options PASSED [ 42%]
tests/unit/middleware/test_security_middleware.py::TestSecurityHeadersMiddleware::test_referrer_policy PASSED [ 42%]
tests/unit/middleware/test_security_middleware.py::TestSecurityHeadersMiddleware::test_permissions_policy PASSED [ 43%]
tests/unit/middleware/test_security_middleware.py::TestSecurityHeadersMiddleware::test_sensitive_headers_removed PASSED [ 43%]
tests/unit/middleware/test_security_middleware.py::TestSecurityHeadersMiddleware::test_production_vs_development_headers PASSED [ 43%]
tests/unit/middleware/test_security_middleware.py::TestSecurityHeadersMiddleware::test_multiple_requests_unique_ids PASSED [ 43%]
tests/unit/middleware/test_security_middleware.py::TestSecurityHeadersMiddleware::test_custom_request_id_preserved PASSED [ 43%]
tests/unit/middleware/test_security_middleware.py::TestSecurityHeadersMiddleware::test_error_responses_have_headers PASSED [ 43%]
tests/unit/middleware/test_security_middleware.py::TestSecurityHeadersMiddleware::test_cors_headers_interaction PASSED [ 43%]
tests/unit/middleware/test_security_middleware.py::TestSecurityHeadersMiddleware::test_post_request_headers PASSED [ 43%]
tests/unit/middleware/test_security_middleware.py::TestSecurityHeadersMiddleware::test_csp_report_only_mode PASSED [ 43%]
tests/unit/middleware/test_security_middleware.py::TestTrustedHostMiddleware::test_trusted_host_validation PASSED [ 43%]
tests/unit/middleware/test_security_middleware.py::TestSecurityMiddlewareOrder::test_middleware_order PASSED [ 43%]
tests/unit/middleware/test_session_middleware.py::TestSessionMiddleware::test_no_session_cookie PASSED [ 43%]
tests/unit/middleware/test_session_middleware.py::TestSessionMiddleware::test_valid_session_cookie PASSED [ 43%]
tests/unit/middleware/test_session_middleware.py::TestSessionMiddleware::test_invalid_session_cookie PASSED [ 43%]
tests/unit/middleware/test_session_middleware.py::TestSessionMiddleware::test_session_creation PASSED [ 43%]
tests/unit/middleware/test_session_middleware.py::TestSessionMiddleware::test_session_deletion PASSED [ 43%]
tests/unit/middleware/test_session_middleware.py::TestSessionMiddleware::test_session_rotation_recommendation PASSED [ 43%]
tests/unit/middleware/test_session_middleware.py::TestSessionMiddleware::test_session_loading_error PASSED [ 43%]
tests/unit/middleware/test_session_middleware.py::TestSessionMiddleware::test_session_cookie_security[cookie_attributes0] PASSED [ 44%]
tests/unit/middleware/test_session_middleware.py::TestSessionMiddleware::test_session_cookie_security[cookie_attributes1] PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareInit::test_init PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareDispatch::test_dispatch_no_session PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareDispatch::test_dispatch_with_valid_session PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareDispatch::test_dispatch_with_invalid_session PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareDispatch::test_dispatch_session_rotation_recommended PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareDispatch::test_dispatch_session_loading_error PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareDispatch::test_dispatch_new_session_creation PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareDispatch::test_dispatch_session_deletion PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareDispatch::test_dispatch_session_rotation PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareDispatch::test_dispatch_rotation_without_session PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareDispatch::test_dispatch_rotation_failure PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareDispatch::test_dispatch_no_client_info PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareCookieHandling::test_set_session_cookie PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareCookieHandling::test_set_session_cookie_insecure PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareCookieHandling::test_clear_session_cookie PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionHelperFunctions::test_create_session_for_user PASSED [ 44%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionHelperFunctions::test_create_session_for_user_no_data PASSED [ 45%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionHelperFunctions::test_delete_current_session PASSED [ 45%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionHelperFunctions::test_rotate_current_session PASSED [ 45%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareIntegration::test_full_session_lifecycle PASSED [ 45%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareIntegration::test_concurrent_session_operations PASSED [ 45%]
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareIntegration::test_session_validation_with_missing_data PASSED [ 45%]
tests/unit/models/test_api_key.py::TestAPIKeyModel::test_api_key_creation PASSED [ 45%]
tests/unit/models/test_api_key.py::TestAPIKeyModel::test_key_prefix_validation PASSED [ 45%]
tests/unit/models/test_api_key.py::TestAPIKeyModel::test_permissions_validation PASSED [ 45%]
tests/unit/models/test_api_key.py::TestAPIKeyModel::test_expiration_logic PASSED [ 45%]
tests/unit/models/test_api_key.py::TestAPIKeyModel::test_soft_deleted_key_validity PASSED [ 45%]
tests/unit/models/test_api_key.py::TestAPIKeyModel::test_record_usage PASSED [ 45%]
tests/unit/models/test_api_key.py::TestAPIKeyModel::test_has_permission PASSED [ 45%]
tests/unit/models/test_api_key.py::TestAPIKeyModel::test_admin_permission_override PASSED [ 45%]
tests/unit/models/test_api_key.py::TestAPIKeyModel::test_invalid_key_has_no_permissions PASSED [ 45%]
tests/unit/models/test_api_key.py::TestAPIKeyModel::test_api_key_repr PASSED [ 45%]
tests/unit/models/test_api_key.py::TestAPIKeyModel::test_to_dict_method PASSED [ 45%]
tests/unit/models/test_api_key.py::TestAPIKeyModel::test_unique_constraints PASSED [ 46%]
tests/unit/models/test_api_key.py::TestAPIKeyModel::test_security_validation_inheritance PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyModelCreation::test_api_key_creation_minimal PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyModelCreation::test_api_key_creation_full_fields PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyModelCreation::test_api_key_inherits_from_base_model_mixin PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_key_hash_success PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_key_hash_empty PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_key_hash_wrong_length PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_key_hash_invalid_characters PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_name_success PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_name_empty PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_name_too_long PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_name_calls_security_validation PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_description_success PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_description_none PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_description_too_long PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_description_calls_security_validation PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_key_prefix_success PASSED [ 46%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_key_prefix_empty PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_key_prefix_too_short PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_key_prefix_too_long PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_key_prefix_invalid_characters PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_last_used_ip_success PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_last_used_ip_none PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_last_used_ip_calls_mixin_validation PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_permissions_success PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_permissions_not_dict PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_permissions_invalid_scope PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_permissions_non_boolean_value PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_permissions_wildcard_scopes PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_is_expired_no_expiration PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_is_expired_future_expiration PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_is_expired_past_expiration PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_is_expired_exact_expiration PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_is_expired_naive_datetime PASSED [ 47%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_is_expired_naive_past_datetime PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_is_active_not_deleted_not_expired PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_is_active_deleted PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_is_active_expired PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_is_active_is_deleted_none PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_is_valid_property PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_record_usage_first_time PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_record_usage_subsequent_times PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_record_usage_without_ip PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_record_usage_with_none_ip PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_has_permission_inactive_key PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_has_permission_no_permissions PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_has_permission_none_permissions PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_has_permission_admin_permission PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_has_permission_wildcard_permission PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_has_permission_specific_permission PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_has_permission_resource_wildcard PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyBusinessLogic::test_has_permission_no_colon_in_permission PASSED [ 48%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyRepresentation::test_repr_active_key PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyRepresentation::test_repr_inactive_key PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyRepresentation::test_to_dict_minimal PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyRepresentation::test_to_dict_full_data PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyConstraintsAndConfig::test_model_constraints PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyConstraintsAndConfig::test_model_config PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyConstraintsAndConfig::test_table_name PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyFieldProperties::test_key_hash_field_properties PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyFieldProperties::test_name_field_properties PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyFieldProperties::test_description_field_properties PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyFieldProperties::test_key_prefix_field_properties PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyFieldProperties::test_permissions_field_properties PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyFieldProperties::test_usage_tracking_field_properties PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyFieldProperties::test_expires_at_field_properties PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyFieldProperties::test_user_id_field_properties PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyRelationships::test_user_relationship PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidationEdgeCases::test_validation_with_security_failure PASSED [ 49%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidationEdgeCases::test_key_hash_case_insensitive PASSED [ 50%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidationEdgeCases::test_permissions_valid_scopes_coverage PASSED [ 50%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyIntegrationScenarios::test_api_key_lifecycle PASSED [ 50%]
tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyIntegrationScenarios::test_permission_hierarchy PASSED [ 50%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_audit_log_creation PASSED [ 50%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_action_validation PASSED [ 50%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_status_validation PASSED [ 50%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_changes_validation PASSED [ 50%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_metadata_field PASSED [ 50%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_log_action_class_method PASSED [ 50%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_system_actions PASSED [ 50%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_error_logging PASSED [ 50%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_performance_tracking PASSED [ 50%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_audit_log_repr PASSED [ 50%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_to_dict_method PASSED [ 50%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_no_soft_delete_on_audit_log PASSED [ 50%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_no_version_tracking_on_audit_log PASSED [ 50%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_security_validation_on_fields PASSED [ 50%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_red_team_specific_actions PASSED [ 51%]
tests/unit/models/test_audit_log.py::TestAuditLogModel::test_immutability_concept PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogModelCreation::test_audit_log_creation_minimal PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogModelCreation::test_audit_log_creation_full_fields PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogModelCreation::test_audit_log_inherits_from_mixins PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogModelCreation::test_audit_log_table_name PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_action_success PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_action_empty PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_action_too_long PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_action_missing_dot PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_action_invalid_characters PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_action_lowercases_result PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_resource_type_success PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_resource_type_empty PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_resource_type_too_long PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_resource_type_calls_security_validation PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_resource_type_lowercases_result PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_status_success PASSED [ 51%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_status_invalid PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_ip_address_field_success PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_ip_address_field_none PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_ip_address_field_calls_mixin_validation PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_user_email_success PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_user_email_none PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidations::test_validate_user_email_calls_mixin_validation PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogClassMethods::test_create_log_minimal PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogClassMethods::test_create_log_full_parameters PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogClassMethods::test_create_log_string_user_id PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogClassMethods::test_create_log_uuid_user_id PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogClassMethods::test_create_log_none_user_id PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogClassMethods::test_create_log_empty_string_user_id PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogClassMethods::test_log_action_minimal PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogClassMethods::test_log_action_with_request_id PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogClassMethods::test_log_action_with_metadata PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogClassMethods::test_log_action_with_request_id_and_metadata PASSED [ 52%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogClassMethods::test_log_action_full_parameters PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogClassMethods::test_log_action_with_failure_status PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogRepresentation::test_repr_with_resource_id PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogRepresentation::test_repr_without_resource_id PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogRepresentation::test_repr_with_failure_status PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogRepresentation::test_to_dict_minimal PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogRepresentation::test_to_dict_full_data PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogRepresentation::test_to_dict_with_error PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogConstraintsAndConfig::test_model_constraints PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogConstraintsAndConfig::test_model_config PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogFieldProperties::test_action_field_properties PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogFieldProperties::test_resource_type_field_properties PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogFieldProperties::test_resource_id_field_properties PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogFieldProperties::test_user_fields_properties PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogFieldProperties::test_request_fields_properties PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogFieldProperties::test_json_fields_properties PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogFieldProperties::test_status_field_properties PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogFieldProperties::test_error_message_field_properties PASSED [ 53%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogFieldProperties::test_duration_field_properties PASSED [ 54%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidationEdgeCases::test_validation_with_security_failure PASSED [ 54%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidationEdgeCases::test_action_validation_sql_keywords_allowed PASSED [ 54%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogValidationEdgeCases::test_create_log_invalid_uuid_string PASSED [ 54%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogIntegrationScenarios::test_audit_log_complete_lifecycle PASSED [ 54%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogIntegrationScenarios::test_system_action_without_user PASSED [ 54%]
tests/unit/models/test_audit_log_comprehensive.py::TestAuditLogIntegrationScenarios::test_failed_action_with_error_details PASSED [ 54%]
tests/unit/models/test_mixins.py::TestAuditMixin::test_audit_fields_present PASSED [ 54%]
tests/unit/models/test_mixins.py::TestAuditMixin::test_id_generation PASSED [ 54%]
tests/unit/models/test_mixins.py::TestAuditMixin::test_timestamps PASSED [ 54%]
tests/unit/models/test_mixins.py::TestSoftDeleteMixin::test_soft_delete_fields PASSED [ 54%]
tests/unit/models/test_mixins.py::TestSoftDeleteMixin::test_soft_delete_method PASSED [ 54%]
tests/unit/models/test_mixins.py::TestSoftDeleteMixin::test_restore_method PASSED [ 54%]
tests/unit/models/test_mixins.py::TestSecurityValidationMixin::test_sql_injection_detection PASSED [ 54%]
tests/unit/models/test_mixins.py::TestSecurityValidationMixin::test_xss_detection PASSED [ 54%]
tests/unit/models/test_mixins.py::TestSecurityValidationMixin::test_valid_strings_pass PASSED [ 54%]
tests/unit/models/test_mixins.py::TestSecurityValidationMixin::test_string_length_validation PASSED [ 54%]
tests/unit/models/test_mixins.py::TestSecurityValidationMixin::test_email_validation PASSED [ 55%]
tests/unit/models/test_mixins.py::TestOptimisticLockMixin::test_version_field_present PASSED [ 55%]
tests/unit/models/test_mixins.py::TestOptimisticLockMixin::test_version_increment_on_update PASSED [ 55%]
tests/unit/models/test_mixins.py::TestRowLevelSecurityMixin::test_rls_fields_present PASSED [ 55%]
tests/unit/models/test_mixins.py::TestBaseModelMixin::test_all_mixins_included PASSED [ 55%]
tests/unit/models/test_mixins.py::TestMixinIntegration::test_create_and_save_model PASSED [ 55%]
tests/unit/models/test_mixins.py::TestMixinIntegration::test_soft_delete_query_filtering PASSED [ 55%]
tests/unit/models/test_mixins.py::TestMixinIntegration::test_optimistic_locking_conflict PASSED [ 55%]
tests/unit/models/test_models_comprehensive.py::TestAPIKeyModel::test_api_key_str_representation PASSED [ 55%]
tests/unit/models/test_models_comprehensive.py::TestAPIKeyModel::test_api_key_repr PASSED [ 55%]
tests/unit/models/test_models_comprehensive.py::TestAPIKeyModel::test_api_key_is_expired_not_set PASSED [ 55%]
tests/unit/models/test_models_comprehensive.py::TestAPIKeyModel::test_api_key_is_expired_future PASSED [ 55%]
tests/unit/models/test_models_comprehensive.py::TestAPIKeyModel::test_api_key_is_expired_past PASSED [ 55%]
tests/unit/models/test_models_comprehensive.py::TestAPIKeyModel::test_api_key_has_permission_exists PASSED [ 55%]
tests/unit/models/test_models_comprehensive.py::TestAPIKeyModel::test_api_key_has_permission_false PASSED [ 55%]
tests/unit/models/test_models_comprehensive.py::TestAPIKeyModel::test_api_key_has_permission_not_exists PASSED [ 55%]
tests/unit/models/test_models_comprehensive.py::TestAPIKeyModel::test_api_key_has_permission_empty_permissions PASSED [ 55%]
tests/unit/models/test_models_comprehensive.py::TestAPIKeyModel::test_api_key_mask_key_various_lengths PASSED [ 55%]
tests/unit/models/test_models_comprehensive.py::TestAPIKeyModel::test_api_key_mask_key_none PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestAPIKeyModel::test_api_key_mask_key_empty PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestAPIKeyModel::test_api_key_relationships PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestAuditLogModel::test_audit_log_str_representation PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestAuditLogModel::test_audit_log_repr PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestAuditLogModel::test_audit_log_get_changes_dict PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestAuditLogModel::test_audit_log_get_changes_none PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestAuditLogModel::test_audit_log_get_changes_empty_string PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestAuditLogModel::test_audit_log_get_changes_invalid_json PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestAuditLogModel::test_audit_log_get_metadata_dict PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestAuditLogModel::test_audit_log_get_metadata_none PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestAuditLogModel::test_audit_log_get_metadata_empty_string PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestAuditLogModel::test_audit_log_get_metadata_invalid_json PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestAuditLogModel::test_audit_log_relationships PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestUserModel::test_user_str_representation PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestUserModel::test_user_repr PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestUserModel::test_user_relationships PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestUserModel::test_user_cascade_delete PASSED [ 56%]
tests/unit/models/test_models_comprehensive.py::TestMixins::test_base_model_mixin_dict_conversion PASSED [ 57%]
tests/unit/models/test_models_comprehensive.py::TestMixins::test_soft_delete_mixin_properties PASSED [ 57%]
tests/unit/models/test_models_comprehensive.py::TestMixins::test_audit_mixin_update_tracking PASSED [ 57%]
tests/unit/models/test_models_comprehensive.py::TestMixins::test_security_validation_mixin PASSED [ 57%]
tests/unit/models/test_models_comprehensive.py::TestMixins::test_optimistic_lock_mixin PASSED [ 57%]
tests/unit/models/test_models_comprehensive.py::TestMixins::test_row_level_security_mixin PASSED [ 57%]
tests/unit/models/test_user.py::TestUserModel::test_user_creation PASSED [ 57%]
tests/unit/models/test_user.py::TestUserModel::test_username_validation PASSED [ 57%]
tests/unit/models/test_user.py::TestUserModel::test_email_validation PASSED [ 57%]
tests/unit/models/test_user.py::TestUserModel::test_password_hash_validation PASSED [ 57%]
tests/unit/models/test_user.py::TestUserModel::test_security_validation_inheritance PASSED [ 57%]
tests/unit/models/test_user.py::TestUserModel::test_audit_fields_inheritance PASSED [ 57%]
tests/unit/models/test_user.py::TestUserModel::test_soft_delete_functionality PASSED [ 57%]
tests/unit/models/test_user.py::TestUserModel::test_user_repr PASSED     [ 57%]
tests/unit/models/test_user.py::TestUserModel::test_to_dict_method PASSED [ 57%]
tests/unit/models/test_user.py::TestUserModel::test_unique_constraints PASSED [ 57%]
tests/unit/models/test_user.py::TestUserModel::test_case_insensitive_username PASSED [ 57%]
tests/unit/models/test_user.py::TestUserModel::test_row_level_security_fields PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserModelCreation::test_user_creation_minimal PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserModelCreation::test_user_creation_full_fields PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserModelCreation::test_user_inherits_from_base_model_mixin PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_username_success PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_username_empty PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_username_too_short PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_username_too_long PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_username_invalid_characters PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_username_calls_security_validation PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_email_field_success PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_email_field_empty PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_email_field_calls_mixin_validation PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_email_field_calls_security_validation PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_email_field_handles_none_from_mixin PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_password_hash_success PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_password_hash_empty PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_password_hash_not_argon2 PASSED [ 58%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_full_name_success PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_full_name_none PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_full_name_too_long PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserValidations::test_validate_full_name_calls_security_validation PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserRepresentation::test_repr PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserRepresentation::test_repr_inactive_user PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserRepresentation::test_to_dict_minimal PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserRepresentation::test_to_dict_full_data PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserConstraintsAndConfig::test_model_constraints PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserConstraintsAndConfig::test_model_config PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserConstraintsAndConfig::test_table_name PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserFieldProperties::test_username_field_properties PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserFieldProperties::test_email_field_properties PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserFieldProperties::test_password_hash_field_properties PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserFieldProperties::test_full_name_field_properties PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserFieldProperties::test_boolean_field_properties PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserFieldProperties::test_datetime_field_properties PASSED [ 59%]
tests/unit/models/test_user_comprehensive.py::TestUserFieldProperties::test_last_login_ip_field_properties PASSED [ 60%]
tests/unit/models/test_user_comprehensive.py::TestUserRelationships::test_api_keys_relationship PASSED [ 60%]
tests/unit/models/test_user_comprehensive.py::TestUserValidationEdgeCases::test_validation_with_security_failure PASSED [ 60%]
tests/unit/models/test_user_comprehensive.py::TestUserValidationEdgeCases::test_validation_preserves_original_exceptions PASSED [ 60%]
tests/unit/models/test_user_comprehensive.py::TestUserValidationEdgeCases::test_email_validation_assertion_coverage PASSED [ 60%]
tests/unit/models/test_user_comprehensive.py::TestUserIntegrationScenarios::test_user_creation_with_all_validations PASSED [ 60%]
tests/unit/models/test_user_comprehensive.py::TestUserIntegrationScenarios::test_user_modification_triggers_validation PASSED [ 60%]
tests/unit/repositories/test_base_repository.py::TestBaseRepository::test_repository_initialization PASSED [ 60%]
tests/unit/repositories/test_base_repository.py::TestBaseRepository::test_create_generates_uuid PASSED [ 60%]
tests/unit/repositories/test_base_repository.py::TestBaseRepository::test_create_with_provided_id PASSED [ 60%]
tests/unit/repositories/test_base_repository.py::TestBaseRepository::test_exists_method PASSED [ 60%]
tests/unit/repositories/test_base_repository.py::TestBaseRepository::test_count_method PASSED [ 60%]
tests/unit/repositories/test_base_repository.py::TestBaseRepository::test_count_with_filters PASSED [ 60%]
tests/unit/repositories/test_base_repository.py::TestPageModel::test_page_initialization PASSED [ 60%]
tests/unit/repositories/test_base_repository.py::TestPageModel::test_page_calculation_edge_cases PASSED [ 60%]
tests/unit/schemas/test_common_comprehensive.py::TestErrorResponse::test_error_response_minimal PASSED [ 60%]
tests/unit/schemas/test_common_comprehensive.py::TestErrorResponse::test_error_response_full PASSED [ 60%]
tests/unit/schemas/test_common_comprehensive.py::TestErrorResponse::test_error_response_auto_timestamp PASSED [ 60%]
tests/unit/schemas/test_common_comprehensive.py::TestErrorResponse::test_error_response_dict_export PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestErrorResponse::test_error_response_json_export PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestErrorResponse::test_error_response_from_dict PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestValidationErrorResponse::test_validation_error_response_minimal PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestValidationErrorResponse::test_validation_error_response_full PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestValidationErrorResponse::test_validation_error_complex_detail PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestValidationErrorResponse::test_validation_error_empty_detail PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestValidationErrorResponse::test_validation_error_missing_detail PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestHealthResponse::test_health_response_create PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestHealthResponse::test_health_response_unhealthy PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestHealthResponse::test_health_response_required_fields PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestHealthResponse::test_health_response_various_statuses PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestPaginationParams::test_pagination_params_defaults PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestPaginationParams::test_pagination_params_custom PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestPaginationParams::test_pagination_params_skip_calculation PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestPaginationParams::test_pagination_params_validation PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestPaginationParams::test_pagination_params_edge_cases PASSED [ 61%]
tests/unit/schemas/test_common_comprehensive.py::TestPaginationParams::test_pagination_params_properties PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestPaginatedResponse::test_paginated_response_basic PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestPaginatedResponse::test_paginated_response_auto_total_pages PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestPaginatedResponse::test_paginated_response_total_pages_calculation PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestPaginatedResponse::test_paginated_response_complex_types PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestPaginatedResponse::test_paginated_response_empty PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestPaginatedResponse::test_paginated_response_validation PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestPaginatedResponse::test_paginated_response_field_validator PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestPaginatedResponse::test_paginated_response_edge_case_page_size_zero PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestIdempotencyHeader::test_idempotency_header_none PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestIdempotencyHeader::test_idempotency_header_valid PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestIdempotencyHeader::test_idempotency_header_pattern_validation PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestIdempotencyHeader::test_idempotency_header_length_validation PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestIdempotencyHeader::test_idempotency_header_optional PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestIdempotencyHeader::test_idempotency_header_serialization PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestSchemaIntegration::test_error_response_in_api_context PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestSchemaIntegration::test_pagination_in_api_context PASSED [ 62%]
tests/unit/schemas/test_common_comprehensive.py::TestSchemaIntegration::test_validation_error_from_pydantic PASSED [ 62%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserBase::test_user_base_valid PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserBase::test_user_base_minimal PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserBase::test_username_validation PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserBase::test_email_validation PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserBase::test_full_name_validation PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserBase::test_boolean_fields PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserBase::test_user_base_dict_export PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserCreate::test_user_create_valid PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserCreate::test_user_create_minimal PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserCreate::test_password_validation_strength PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserCreate::test_password_special_characters PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserCreate::test_user_create_inherits_validation PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserCreate::test_user_create_full_name_sanitization PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserUpdate::test_user_update_all_fields PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserUpdate::test_user_update_partial PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserUpdate::test_user_update_empty PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserUpdate::test_user_update_email_validation PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserUpdate::test_user_update_full_name_validation PASSED [ 63%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserUpdate::test_user_update_dict_exclude_none PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserUpdatePassword::test_password_update_valid PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserUpdatePassword::test_password_update_same_passwords PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserUpdatePassword::test_new_password_validation PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserUpdatePassword::test_current_password_no_validation PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserUpdatePassword::test_password_update_required_fields PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserResponse::test_user_response_complete PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserResponse::test_user_response_minimal PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserResponse::test_user_response_from_orm PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserResponse::test_user_response_datetime_handling PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserResponse::test_user_response_validation_inherited PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserResponse::test_user_response_counter_fields PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserCreateResponse::test_user_create_response_default_message PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserCreateResponse::test_user_create_response_custom_message PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserCreateResponse::test_user_create_response_inherits_user_response PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserListResponse::test_user_list_response_empty PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserListResponse::test_user_list_response_with_users PASSED [ 64%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserListResponse::test_user_list_response_pagination_inheritance PASSED [ 65%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserListResponse::test_user_list_response_type_validation PASSED [ 65%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserSchemaEdgeCases::test_unicode_handling PASSED [ 65%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserSchemaEdgeCases::test_email_normalization PASSED [ 65%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserSchemaEdgeCases::test_field_aliasing PASSED [ 65%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserSchemaEdgeCases::test_extra_fields_forbidden PASSED [ 65%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserSchemaEdgeCases::test_json_serialization PASSED [ 65%]
tests/unit/schemas/test_user_schema_comprehensive.py::TestUserSchemaEdgeCases::test_schema_validation_error_details PASSED [ 65%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_create_api_key_success PASSED [ 65%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_create_api_key_with_invalid_name PASSED [ 65%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_create_api_key_with_no_scopes PASSED [ 65%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_validate_api_key_success PASSED [ 65%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_validate_api_key_not_found PASSED [ 65%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_validate_api_key_inactive PASSED [ 65%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_validate_api_key_expired PASSED [ 65%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_validate_api_key_user_inactive PASSED [ 65%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_rotate_api_key_success PASSED [ 65%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_rotate_api_key_not_found PASSED [ 65%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_revoke_api_key_success PASSED [ 66%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_revoke_api_key_already_revoked PASSED [ 66%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_list_user_api_keys PASSED [ 66%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_list_user_api_keys_active_only PASSED [ 66%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_check_api_key_permissions PASSED [ 66%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_cleanup_expired_keys PASSED [ 66%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_generate_secure_key PASSED [ 66%]
tests/unit/services/test_api_key_service.py::TestAPIKeyService::test_hash_key PASSED [ 66%]
tests/unit/services/test_audit_service.py::TestAuditService::test_log_event_success PASSED [ 66%]
tests/unit/services/test_audit_service.py::TestAuditService::test_log_event_with_sensitive_data_sanitization PASSED [ 66%]
tests/unit/services/test_audit_service.py::TestAuditService::test_log_event_with_exception_handling PASSED [ 66%]
tests/unit/services/test_audit_service.py::TestAuditService::test_log_auth_event_success PASSED [ 66%]
tests/unit/services/test_audit_service.py::TestAuditService::test_log_auth_event_failure PASSED [ 66%]
tests/unit/services/test_audit_service.py::TestAuditService::test_log_permission_event PASSED [ 66%]
tests/unit/services/test_audit_service.py::TestAuditService::test_log_api_key_event PASSED [ 66%]
tests/unit/services/test_audit_service.py::TestAuditService::test_log_resource_event PASSED [ 66%]
tests/unit/services/test_audit_service.py::TestAuditService::test_log_security_event PASSED [ 66%]
tests/unit/services/test_audit_service.py::TestAuditService::test_get_user_activity PASSED [ 67%]
tests/unit/services/test_audit_service.py::TestAuditService::test_get_resource_history PASSED [ 67%]
tests/unit/services/test_audit_service.py::TestAuditService::test_get_failed_auth_attempts PASSED [ 67%]
tests/unit/services/test_audit_service.py::TestAuditService::test_get_security_events PASSED [ 67%]
tests/unit/services/test_audit_service.py::TestAuditService::test_get_audit_statistics PASSED [ 67%]
tests/unit/services/test_audit_service.py::TestAuditService::test_search_audit_logs PASSED [ 67%]
tests/unit/services/test_audit_service.py::TestAuditService::test_export_audit_logs_json PASSED [ 67%]
tests/unit/services/test_audit_service.py::TestAuditService::test_export_audit_logs_csv PASSED [ 67%]
tests/unit/services/test_audit_service.py::TestAuditService::test_cleanup_old_logs PASSED [ 67%]
tests/unit/services/test_audit_service.py::TestAuditService::test_sanitize_sensitive_data PASSED [ 67%]
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_create_policy_success PASSED [ 67%]
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_create_policy_invalid_enforcement_level PASSED [ 67%]
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_create_policy_invalid_method PASSED [ 67%]
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_policy_conditions_roles PASSED [ 67%]
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_policy_conditions_superuser PASSED [ 67%]
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_policy_conditions_account_age PASSED [ 67%]
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_mfa_requirement_no_policies PASSED [ 67%]
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_mfa_requirement_required_policy PASSED [ 67%]
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_mfa_requirement_grace_period PASSED [ 68%]
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_update_policy_success PASSED [ 68%]
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_delete_policy_success PASSED [ 68%]
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_list_policies_success PASSED [ 68%]
tests/unit/services/test_mfa_service.py::TestMFAService::test_setup_totp_success PASSED [ 68%]
tests/unit/services/test_mfa_service.py::TestMFAService::test_setup_totp_existing_verified_device PASSED [ 68%]
tests/unit/services/test_mfa_service.py::TestMFAService::test_verify_totp_setup_success PASSED [ 68%]
tests/unit/services/test_mfa_service.py::TestMFAService::test_verify_totp_setup_invalid_token PASSED [ 68%]
tests/unit/services/test_mfa_service.py::TestMFAService::test_create_mfa_challenge_success PASSED [ 68%]
tests/unit/services/test_mfa_service.py::TestMFAService::test_create_mfa_challenge_no_device PASSED [ 68%]
tests/unit/services/test_mfa_service.py::TestMFAService::test_verify_mfa_challenge_totp_success PASSED [ 68%]
tests/unit/services/test_mfa_service.py::TestMFAService::test_verify_mfa_challenge_max_attempts PASSED [ 68%]
tests/unit/services/test_mfa_service.py::TestMFAService::test_remove_mfa_device_success PASSED [ 68%]
tests/unit/services/test_mfa_service.py::TestMFAService::test_check_mfa_required_with_active_device PASSED [ 68%]
tests/unit/services/test_mfa_service.py::TestMFAService::test_check_mfa_required_no_device PASSED [ 68%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_create_application_success PASSED [ 68%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_create_application_invalid_name PASSED [ 68%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_create_application_no_redirect_uris PASSED [ 68%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_create_application_localhost_production PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_validate_client_success PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_validate_client_not_found PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_validate_client_inactive PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_create_authorization_code PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_exchange_authorization_code_success PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_exchange_authorization_code_already_used PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_exchange_authorization_code_expired PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_exchange_authorization_code_with_pkce PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_refresh_access_token_success PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_refresh_access_token_scope_reduction PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_refresh_access_token_invalid_scope_request PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_validate_access_token_success PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_validate_access_token_invalid PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_revoke_token_access_token PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_revoke_token_refresh_token PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_list_user_authorizations PASSED [ 69%]
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_revoke_user_authorization PASSED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_create_role_success PASSED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_create_role_duplicate_name PASSED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_create_role_invalid_permissions SKIPPED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_assign_role_to_user_success PASSED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_assign_role_to_user_already_assigned PASSED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_assign_system_role_forbidden SKIPPED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_revoke_role_from_user_success PASSED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_revoke_role_from_user_not_assigned PASSED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_get_user_permissions_with_roles PASSED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_get_user_permissions_superuser PASSED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_check_user_permission_allowed PASSED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_check_user_permission_denied PASSED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_check_user_permission_wildcard PASSED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_check_user_permission_ownership SKIPPED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_create_permission_success SKIPPED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_get_role_hierarchy PASSED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_can_manage_role_based_on_hierarchy PASSED [ 70%]
tests/unit/services/test_rbac_service.py::TestRBACService::test_cannot_manage_role_based_on_hierarchy PASSED [ 71%]
tests/unit/test_auth_failover.py::TestCacheManager::test_cache_fallback_when_redis_unavailable PASSED [ 71%]
tests/unit/test_auth_failover.py::TestCacheManager::test_cache_pattern_matching PASSED [ 71%]
tests/unit/test_auth_failover.py::TestCircuitBreaker::test_circuit_breaker_opens_after_failures PASSED [ 71%]
tests/unit/test_auth_failover.py::TestCircuitBreaker::test_circuit_breaker_half_open_recovery PASSED [ 71%]
tests/unit/test_auth_failover.py::TestFallbackAuthProvider::test_cache_user_credentials PASSED [ 71%]
tests/unit/test_auth_failover.py::TestFallbackAuthProvider::test_authenticate_fallback_success PASSED [ 71%]
tests/unit/test_auth_failover.py::TestFallbackAuthProvider::test_authenticate_fallback_invalid_password PASSED [ 71%]
tests/unit/test_auth_failover.py::TestFallbackAuthProvider::test_create_emergency_token PASSED [ 71%]
tests/unit/test_auth_failover.py::TestFallbackAuthProvider::test_emergency_token_expiration PASSED [ 71%]
tests/unit/test_auth_failover.py::TestFallbackAuthProvider::test_authenticate_with_fallback_primary_fails PASSED [ 71%]
tests/unit/test_config.py::TestConfiguration::test_valid_configuration PASSED [ 71%]
tests/unit/test_config.py::TestConfiguration::test_invalid_database_url PASSED [ 71%]
tests/unit/test_config.py::TestConfiguration::test_invalid_redis_url PASSED [ 71%]
tests/unit/test_config.py::TestConfiguration::test_missing_required_settings PASSED [ 71%]
tests/unit/test_config.py::TestConfiguration::test_secret_key_minimum_length PASSED [ 71%]
tests/unit/test_config.py::TestConfiguration::test_environment_validation PASSED [ 71%]
tests/unit/test_config.py::TestConfiguration::test_default_values PASSED [ 72%]
tests/unit/test_config.py::TestConfiguration::test_is_production_property PASSED [ 72%]
tests/unit/test_config.py::TestConfiguration::test_database_url_safe PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsValidation::test_minimal_valid_settings PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsValidation::test_production_settings_validation PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsValidation::test_production_debug_error PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsValidation::test_weak_secret_key_error PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsValidation::test_short_secret_key_error PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsValidation::test_invalid_environment PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsValidation::test_invalid_database_url PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsValidation::test_invalid_redis_url PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsValidation::test_invalid_server_host PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsValidation::test_valid_server_hosts PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsValidation::test_rate_limiting_validation PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsProperties::test_is_production_property PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsProperties::test_is_development_property PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsProperties::test_database_url_safe PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsProperties::test_database_url_safe_no_password PASSED [ 72%]
tests/unit/test_enhanced_config.py::TestSettingsProperties::test_database_url_safe_none PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestSettingsProperties::test_redis_url_safe PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestSettingsProperties::test_get_database_config PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestSettingsProperties::test_get_redis_config PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestSettingsProperties::test_get_security_config PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestSettingsProperties::test_validate_configuration PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestSettingsProperties::test_validate_configuration_missing_secret PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestSettingsProperties::test_generate_secret_key PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestSettingsProperties::test_to_dict PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestAllowedOrigins::test_default_origins PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestAllowedOrigins::test_valid_origins PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestAllowedOrigins::test_invalid_origins_filtered PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestGetSettings::test_get_settings_returns_instance PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestGetSettings::test_get_settings_caching PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestGetSettings::test_reload_settings PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestGetSettings::test_get_settings_with_invalid_config PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestEnvironmentFileValidation::test_missing_env_file PASSED [ 73%]
tests/unit/test_enhanced_config.py::TestEnvironmentFileValidation::test_valid_env_file PASSED [ 74%]
tests/unit/test_enhanced_config.py::TestEnvironmentFileValidation::test_env_file_missing_required_vars PASSED [ 74%]
tests/unit/test_enhanced_config.py::TestEnvironmentFileValidation::test_unreadable_env_file PASSED [ 74%]
tests/unit/test_enhanced_config.py::TestConfigurationIntegration::test_production_configuration PASSED [ 74%]
tests/unit/test_enhanced_config.py::TestConfigurationIntegration::test_development_configuration PASSED [ 74%]
tests/unit/test_enhanced_config.py::TestConfigurationIntegration::test_configuration_warnings PASSED [ 74%]
tests/unit/test_enhanced_filtering.py::TestFieldFilter::test_equality_operators PASSED [ 74%]
tests/unit/test_enhanced_filtering.py::TestFieldFilter::test_comparison_operators PASSED [ 74%]
tests/unit/test_enhanced_filtering.py::TestFieldFilter::test_collection_operators PASSED [ 74%]
tests/unit/test_enhanced_filtering.py::TestFieldFilter::test_string_operators PASSED [ 74%]
tests/unit/test_enhanced_filtering.py::TestFieldFilter::test_regex_operators PASSED [ 74%]
tests/unit/test_enhanced_filtering.py::TestFieldFilter::test_regex_validation_error PASSED [ 74%]
tests/unit/test_enhanced_filtering.py::TestFieldFilter::test_null_operators PASSED [ 74%]
tests/unit/test_enhanced_filtering.py::TestFieldFilter::test_boolean_operators PASSED [ 74%]
tests/unit/test_enhanced_filtering.py::TestFieldFilter::test_in_operator_validation PASSED [ 74%]
tests/unit/test_enhanced_filtering.py::TestSortField::test_basic_sort_field PASSED [ 74%]
tests/unit/test_enhanced_filtering.py::TestSortField::test_descending_sort_field PASSED [ 74%]
tests/unit/test_enhanced_filtering.py::TestSortField::test_nulls_first_sort_field PASSED [ 74%]
tests/unit/test_enhanced_filtering.py::TestSortField::test_invalid_direction PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestSortField::test_invalid_nulls_option PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestEnhancedFilter::test_default_enhanced_filter PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestEnhancedFilter::test_enhanced_filter_with_field_filters PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestEnhancedFilter::test_enhanced_filter_with_multi_sort PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestEnhancedFilter::test_enhanced_filter_with_date_range PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestEnhancedFilter::test_enhanced_filter_with_search PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestEnhancedFilter::test_enhanced_filter_with_field_selection PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestEnhancedFilter::test_enhanced_filter_with_caching_control PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestEnhancedFilter::test_search_sanitization PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestEnhancedFilter::test_filter_field_name_validation PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestEnhancedFilter::test_sort_field_validation PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestEnhancedFilter::test_pagination_validation PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestEnhancedFilter::test_cache_ttl_validation PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestEnhancedFilter::test_cache_key_components PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestEnhancedFilter::test_cursor_pagination PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestComplexFilteringScenarios::test_complex_user_search_scenario PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestComplexFilteringScenarios::test_audit_log_filtering_scenario PASSED [ 75%]
tests/unit/test_enhanced_filtering.py::TestComplexFilteringScenarios::test_performance_optimized_scenario PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestEnhancedHealthEndpoints::test_health_check_basic PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestEnhancedHealthEndpoints::test_readiness_check_all_healthy PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestEnhancedHealthEndpoints::test_readiness_check_database_unhealthy PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestEnhancedHealthEndpoints::test_readiness_check_multiple_failures PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestEnhancedHealthEndpoints::test_readiness_check_with_exceptions PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestEnhancedHealthEndpoints::test_liveness_check PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestEnhancedHealthEndpoints::test_disk_space_check_healthy PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestEnhancedHealthEndpoints::test_disk_space_check_unhealthy PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestEnhancedHealthEndpoints::test_disk_space_check_custom_threshold PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestEnhancedHealthEndpoints::test_disk_space_check_exception PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestEnhancedHealthEndpoints::test_memory_check_healthy PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestEnhancedHealthEndpoints::test_memory_check_unhealthy PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestEnhancedHealthEndpoints::test_memory_check_custom_threshold PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestEnhancedHealthEndpoints::test_memory_check_exception PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestHealthCheckTracking::test_health_check_metrics_tracked PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestHealthCheckTracking::test_readiness_check_metrics_tracked PASSED [ 76%]
tests/unit/test_enhanced_health.py::TestHealthEndpointIntegration::test_all_health_endpoints_accessible PASSED [ 77%]
tests/unit/test_enhanced_health.py::TestHealthEndpointIntegration::test_health_endpoints_with_no_database_config PASSED [ 77%]
tests/unit/test_errors.py::TestErrorHandling::test_api_error PASSED      [ 77%]
tests/unit/test_errors.py::TestErrorHandling::test_bad_request_error PASSED [ 77%]
tests/unit/test_errors.py::TestErrorHandling::test_unauthorized_error PASSED [ 77%]
tests/unit/test_errors.py::TestErrorHandling::test_forbidden_error PASSED [ 77%]
tests/unit/test_errors.py::TestErrorHandling::test_not_found_error PASSED [ 77%]
tests/unit/test_errors.py::TestErrorHandling::test_conflict_error PASSED [ 77%]
tests/unit/test_errors.py::TestErrorHandling::test_validation_error PASSED [ 77%]
tests/unit/test_errors.py::TestErrorHandling::test_internal_server_error PASSED [ 77%]
tests/unit/test_errors.py::TestErrorHandling::test_pydantic_validation_error PASSED [ 77%]
tests/unit/test_errors.py::TestErrorHandling::test_unhandled_exception PASSED [ 77%]
tests/unit/test_errors.py::TestErrorHandling::test_production_mode_error_masking PASSED [ 77%]
tests/unit/test_git_history_parser.py::TestArchitecturalFix::test_architectural_fix_creation PASSED [ 77%]
tests/unit/test_git_history_parser.py::TestArchitecturalFix::test_architectural_fix_to_dict PASSED [ 77%]
tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_parser_initialization FAILED [ 77%]
tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_parser_initialization_bare_repo FAILED [ 77%]
tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_parser_no_gitpython FAILED [ 77%]
tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_find_architectural_fixes FAILED [ 78%]
tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_find_architectural_fixes_with_adr_filter FAILED [ 78%]
tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_find_file_change_patterns FAILED [ 78%]
tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_is_architectural_file PASSED [ 78%]
tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_get_fix_statistics PASSED [ 78%]
tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_get_fix_statistics_empty PASSED [ 78%]
tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_export_fixes_summary_json PASSED [ 78%]
tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_export_fixes_summary_csv PASSED [ 78%]
tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_export_fixes_summary_markdown PASSED [ 78%]
tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_export_fixes_summary_invalid_format FAILED [ 78%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserRealRepo::test_find_architectural_fixes_real_repo FAILED [ 78%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserRealRepo::test_adr_filtering_real_repo PASSED [ 78%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserRealRepo::test_file_change_patterns_real_repo FAILED [ 78%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserRealRepo::test_statistics_real_repo FAILED [ 78%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserRealRepo::test_export_formats_real_repo PASSED [ 78%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserSecurity::test_path_traversal_protection PASSED [ 78%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserSecurity::test_malicious_commit_messages ERROR [ 78%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserSecurity::test_large_repository_dos PASSED [ 79%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserErrorHandling::test_corrupted_repository PASSED [ 79%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserErrorHandling::test_empty_repository FAILED [ 79%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserErrorHandling::test_permission_errors FAILED [ 79%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserErrorHandling::test_concurrent_access ERROR [ 79%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserPerformance::test_performance_metrics ERROR [ 79%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserPerformance::test_memory_usage ERROR [ 79%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserIntegration::test_integration_with_pattern_matcher ERROR [ 79%]
tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserIntegration::test_architectural_file_detection PASSED [ 79%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_explicit_adr_fix_detection PASSED [ 79%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_architectural_fix_detection PASSED [ 79%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_boundary_fix_detection PASSED [ 79%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_dependency_fix_detection PASSED [ 79%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_refactoring_fix_detection PASSED [ 79%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_implicit_fix_detection PASSED [ 79%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_adr_reference_extraction PASSED [ 79%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_confidence_scoring PASSED [ 79%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_file_path_context PASSED [ 79%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_conventional_commit_handling PASSED [ 80%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_multiline_commit_messages PASSED [ 80%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_no_false_positives PASSED [ 80%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_match_deduplication PASSED [ 80%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_custom_patterns PASSED [ 80%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_case_insensitivity PASSED [ 80%]
tests/unit/test_git_pattern_matcher.py::TestArchitecturalFixPatternMatcher::test_capture_groups PASSED [ 80%]
tests/unit/test_git_pattern_matcher.py::TestFixMatchDataClass::test_fix_match_creation PASSED [ 80%]
tests/unit/test_git_pattern_matcher.py::TestEdgeCases::test_empty_commit_message PASSED [ 80%]
tests/unit/test_git_pattern_matcher.py::TestEdgeCases::test_very_long_commit_message PASSED [ 80%]
tests/unit/test_git_pattern_matcher.py::TestEdgeCases::test_invalid_adr_numbers PASSED [ 80%]
tests/unit/test_git_pattern_matcher.py::TestEdgeCases::test_special_characters_in_message PASSED [ 80%]
tests/unit/test_git_pattern_matcher_comprehensive.py::TestPatternMatcherSecurity::test_redos_protection PASSED [ 80%]
tests/unit/test_git_pattern_matcher_comprehensive.py::TestPatternMatcherSecurity::test_special_characters_handling PASSED [ 80%]
tests/unit/test_git_pattern_matcher_comprehensive.py::TestPatternMatcherSecurity::test_memory_exhaustion_protection PASSED [ 80%]
tests/unit/test_git_pattern_matcher_comprehensive.py::TestPatternMatcherRobustness::test_empty_and_none_inputs PASSED [ 80%]
tests/unit/test_git_pattern_matcher_comprehensive.py::TestPatternMatcherRobustness::test_multiline_edge_cases PASSED [ 80%]
tests/unit/test_git_pattern_matcher_comprehensive.py::TestPatternMatcherRobustness::test_adr_reference_edge_cases FAILED [ 81%]
tests/unit/test_git_pattern_matcher_comprehensive.py::TestPatternMatcherRobustness::test_pattern_priority_and_deduplication PASSED [ 81%]
tests/unit/test_git_pattern_matcher_comprehensive.py::TestPatternMatcherRobustness::test_confidence_calculation_accuracy FAILED [ 81%]
tests/unit/test_git_pattern_matcher_comprehensive.py::TestPatternMatcherCompleteness::test_all_fix_types_covered PASSED [ 81%]
tests/unit/test_git_pattern_matcher_comprehensive.py::TestPatternMatcherCompleteness::test_real_world_commit_messages PASSED [ 81%]
tests/unit/test_git_pattern_matcher_comprehensive.py::TestPatternMatcherCompleteness::test_performance_with_large_inputs PASSED [ 81%]
tests/unit/test_git_pattern_matcher_comprehensive.py::TestCustomPatterns::test_custom_pattern_addition PASSED [ 81%]
tests/unit/test_health_performance.py::TestHealthEndpointPerformance::test_health_check_under_200ms PASSED [ 81%]
tests/unit/test_health_performance.py::TestHealthEndpointPerformance::test_liveness_check_under_200ms PASSED [ 81%]
tests/unit/test_health_performance.py::TestHealthEndpointPerformance::test_readiness_check_under_200ms PASSED [ 81%]
tests/unit/test_health_performance.py::TestHealthEndpointPerformance::test_readiness_with_slow_dependencies PASSED [ 81%]
tests/unit/test_health_performance.py::TestHealthEndpointPerformance::test_parallel_health_checks_performance PASSED [ 81%]
tests/unit/test_health_performance.py::TestHealthEndpointPerformance::test_health_check_caching_performance PASSED [ 81%]
tests/unit/test_middleware.py::TestSecurityHeadersMiddleware::test_security_headers_added PASSED [ 81%]
tests/unit/test_middleware.py::TestSecurityHeadersMiddleware::test_request_id_header PASSED [ 81%]
tests/unit/test_middleware.py::TestRequestIDMiddleware::test_request_id_generated PASSED [ 81%]
tests/unit/test_middleware.py::TestRequestIDMiddleware::test_request_id_preserved PASSED [ 81%]
tests/unit/test_middleware.py::TestRequestIDMiddleware::test_different_requests_different_ids PASSED [ 81%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_should_cache_request_get_method PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_should_not_cache_post_request PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_should_not_cache_when_disabled PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_should_not_cache_no_cache_header PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_should_not_cache_excluded_pattern PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_should_cache_response_success PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_should_not_cache_error_response PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_should_not_cache_no_cache_response PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_should_not_cache_set_cookie_response PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_generate_cache_key PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_generate_cache_key_consistency PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_generate_cache_key_different_params PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_get_cache_ttl PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_match_pattern_exact PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_match_pattern_wildcard PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_get_cached_response_miss PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_get_cached_response_hit PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_get_cached_response_etag_match PASSED [ 82%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_cache_response_success PASSED [ 83%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_cache_response_non_json PASSED [ 83%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_handle_cache_invalidation PASSED [ 83%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_handle_cache_invalidation_no_match PASSED [ 83%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_handle_cache_invalidation_get_request PASSED [ 83%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_warm_cache PASSED [ 83%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheMiddleware::test_get_cache_stats PASSED [ 83%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheIntegration::test_full_middleware_flow_cache_miss PASSED [ 83%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheIntegration::test_full_middleware_flow_cache_hit PASSED [ 83%]
tests/unit/test_response_cache_middleware.py::TestResponseCacheIntegration::test_cache_invalidation_integration PASSED [ 83%]
tests/unit/test_security.py::TestPasswordHashing::test_hash_password PASSED [ 83%]
tests/unit/test_security.py::TestPasswordHashing::test_verify_password_correct PASSED [ 83%]
tests/unit/test_security.py::TestPasswordHashing::test_verify_password_incorrect PASSED [ 83%]
tests/unit/test_security.py::TestPasswordHashing::test_hash_uniqueness PASSED [ 83%]
tests/unit/test_security.py::TestJWTTokens::test_create_access_token PASSED [ 83%]
tests/unit/test_security.py::TestJWTTokens::test_create_refresh_token PASSED [ 83%]
tests/unit/test_security.py::TestJWTTokens::test_decode_valid_token PASSED [ 83%]
tests/unit/test_security.py::TestJWTTokens::test_decode_expired_token PASSED [ 84%]
tests/unit/test_security.py::TestJWTTokens::test_decode_invalid_token PASSED [ 84%]
tests/unit/test_security.py::TestJWTTokens::test_token_expiration PASSED [ 84%]
tests/unit/test_security.py::TestPasswordValidation::test_strong_password PASSED [ 84%]
tests/unit/test_security.py::TestPasswordValidation::test_password_too_short PASSED [ 84%]
tests/unit/test_security.py::TestPasswordValidation::test_password_no_uppercase PASSED [ 84%]
tests/unit/test_security.py::TestPasswordValidation::test_password_no_lowercase PASSED [ 84%]
tests/unit/test_security.py::TestPasswordValidation::test_password_no_digit PASSED [ 84%]
tests/unit/test_security.py::TestPasswordValidation::test_password_no_special PASSED [ 84%]
tests/unit/test_security.py::TestAPIKey::test_generate_api_key_default_length PASSED [ 84%]
tests/unit/test_security.py::TestAPIKey::test_generate_api_key_custom_length PASSED [ 84%]
tests/unit/test_security.py::TestAPIKey::test_api_key_uniqueness PASSED  [ 84%]
tests/unit/utils/test_cache.py::TestCacheClient::test_create_cache_client_no_url PASSED [ 84%]
tests/unit/utils/test_cache.py::TestCacheClient::test_create_cache_client_success PASSED [ 84%]
tests/unit/utils/test_cache.py::TestCacheClient::test_create_cache_client_exception PASSED [ 84%]
tests/unit/utils/test_cache.py::TestCacheClient::test_get_cache_client_creates_new PASSED [ 84%]
tests/unit/utils/test_cache.py::TestCacheClient::test_get_cache_client_cached PASSED [ 84%]
tests/unit/utils/test_cache.py::TestCacheHealth::test_check_cache_health_no_url PASSED [ 84%]
tests/unit/utils/test_cache.py::TestCacheHealth::test_check_cache_health_no_client PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheHealth::test_check_cache_health_success PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheHealth::test_check_cache_health_no_pong PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheHealth::test_check_cache_health_timeout PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheHealth::test_check_cache_health_exception PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheOperations::test_get_cached_value_no_client PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheOperations::test_get_cached_value_success PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheOperations::test_get_cached_value_exception PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheOperations::test_set_cached_value_no_client PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheOperations::test_set_cached_value_success PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheOperations::test_set_cached_value_custom_ttl PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheOperations::test_set_cached_value_exception PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheOperations::test_delete_cached_value_no_client PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheOperations::test_delete_cached_value_success PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheOperations::test_delete_cached_value_not_found PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheOperations::test_delete_cached_value_exception PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheShutdown::test_close_cache_connections_no_client PASSED [ 85%]
tests/unit/utils/test_cache.py::TestCacheShutdown::test_close_cache_connections_success PASSED [ 86%]
tests/unit/utils/test_cache.py::TestCacheShutdown::test_close_cache_connections_resets_global PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreakerConfig::test_default_config PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreakerConfig::test_custom_config PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreakerException::test_exception_creation PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_breaker_initialization PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreaker::test_successful_call PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreaker::test_failed_call PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_opens_after_threshold PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_fails_fast_when_open PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_half_open_after_timeout PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_closes_after_success_threshold PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_reopens_on_failure_in_half_open PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreaker::test_timeout_handling PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreaker::test_sync_function_call PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreaker::test_unexpected_exception_not_counted PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreaker::test_get_stats PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreaker::test_reset PASSED [ 86%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreaker::test_state_check_methods PASSED [ 87%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreakerRegistry::test_get_circuit_breaker_new PASSED [ 87%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreakerRegistry::test_get_circuit_breaker_existing PASSED [ 87%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreakerRegistry::test_get_all_circuit_breaker_stats PASSED [ 87%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreakerRegistry::test_reset_all_circuit_breakers PASSED [ 87%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreakerDecorator::test_decorator_success PASSED [ 87%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreakerDecorator::test_decorator_failure PASSED [ 87%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreakerDecorator::test_decorator_circuit_opening PASSED [ 87%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreakerIntegration::test_multiple_circuit_breakers PASSED [ 87%]
tests/unit/utils/test_circuit_breaker.py::TestCircuitBreakerIntegration::test_real_world_scenario PASSED [ 87%]
tests/unit/utils/test_health_cache.py::TestHealthCheckCaching::test_cache_health_check_result PASSED [ 87%]
tests/unit/utils/test_health_cache.py::TestHealthCheckCaching::test_get_cached_health_check_valid PASSED [ 87%]
tests/unit/utils/test_health_cache.py::TestHealthCheckCaching::test_get_cached_health_check_expired PASSED [ 87%]
tests/unit/utils/test_health_cache.py::TestHealthCheckCaching::test_get_cached_health_check_not_found PASSED [ 87%]
tests/unit/utils/test_health_cache.py::TestHealthCheckCaching::test_clear_health_check_cache PASSED [ 87%]
tests/unit/utils/test_health_cache.py::TestHealthCheckCaching::test_check_dependency_health_uses_cache PASSED [ 87%]
tests/unit/utils/test_health_cache.py::TestHealthCheckCaching::test_check_dependency_health_cache_expired PASSED [ 87%]
tests/unit/utils/test_health_cache.py::TestHealthCheckCaching::test_check_dependency_health_no_cache PASSED [ 87%]
tests/unit/utils/test_health_cache.py::TestHealthCheckCaching::test_check_dependency_health_cache_ttl_zero PASSED [ 88%]
tests/unit/utils/test_health_cache.py::TestHealthCheckCaching::test_cache_expiration_timing PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestHealthCheckTracking::test_track_health_check_success PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestHealthCheckTracking::test_track_health_check_failure PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestHealthCheckTracking::test_track_health_check_exception PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestHealthCheckTracking::test_track_health_check_ready_status PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestRequestPerformanceTracking::test_track_request_performance_success PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestRequestPerformanceTracking::test_track_request_performance_exception PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestRequestPerformanceTracking::test_track_request_performance_active_requests PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestRequestPerformanceTracking::test_track_request_performance_with_request_object PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestSystemMetrics::test_get_system_metrics_success PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestSystemMetrics::test_get_system_metrics_exception PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestConnectionCounting::test_increment_connection_count_database PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestConnectionCounting::test_increment_connection_count_cache PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestConnectionCounting::test_increment_connection_count_invalid_type PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestConnectionCounting::test_decrement_connection_count_database PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestConnectionCounting::test_decrement_connection_count_zero PASSED [ 88%]
tests/unit/utils/test_monitoring.py::TestConnectionCounting::test_decrement_connection_count_invalid_type PASSED [ 89%]
tests/unit/utils/test_monitoring.py::TestDependencyHealth::test_check_dependency_health_all_healthy PASSED [ 89%]
tests/unit/utils/test_monitoring.py::TestDependencyHealth::test_check_dependency_health_database_unhealthy PASSED [ 89%]
tests/unit/utils/test_monitoring.py::TestDependencyHealth::test_check_dependency_health_with_exceptions PASSED [ 89%]
tests/unit/utils/test_monitoring.py::TestDependencyHealth::test_check_dependency_health_complete_failure PASSED [ 89%]
tests/unit/utils/test_retry.py::TestRetryConfig::test_default_config PASSED [ 89%]
tests/unit/utils/test_retry.py::TestRetryConfig::test_custom_config PASSED [ 89%]
tests/unit/utils/test_retry.py::TestRetryConfig::test_tuple_exceptions PASSED [ 89%]
tests/unit/utils/test_retry.py::TestRetryState::test_retry_state_initialization PASSED [ 89%]
tests/unit/utils/test_retry.py::TestRetryState::test_retry_state_tracking PASSED [ 89%]
tests/unit/utils/test_retry.py::TestCalculateDelay::test_first_attempt_no_delay PASSED [ 89%]
tests/unit/utils/test_retry.py::TestCalculateDelay::test_exponential_backoff PASSED [ 89%]
tests/unit/utils/test_retry.py::TestCalculateDelay::test_max_delay_cap PASSED [ 89%]
tests/unit/utils/test_retry.py::TestCalculateDelay::test_jitter_adds_randomness PASSED [ 89%]
tests/unit/utils/test_retry.py::TestCalculateDelay::test_negative_delay_clamped PASSED [ 89%]
tests/unit/utils/test_retry.py::TestRetryAsync::test_successful_first_attempt PASSED [ 89%]
tests/unit/utils/test_retry.py::TestRetryAsync::test_retry_until_success PASSED [ 89%]
tests/unit/utils/test_retry.py::TestRetryAsync::test_all_attempts_fail PASSED [ 89%]
tests/unit/utils/test_retry.py::TestRetryAsync::test_non_retryable_exception PASSED [ 90%]
tests/unit/utils/test_retry.py::TestRetryAsync::test_default_config PASSED [ 90%]
tests/unit/utils/test_retry.py::TestRetryAsync::test_delay_timing PASSED [ 90%]
tests/unit/utils/test_retry.py::TestRetryAsync::test_function_with_args_kwargs PASSED [ 90%]
tests/unit/utils/test_retry.py::TestRetrySync::test_successful_first_attempt PASSED [ 90%]
tests/unit/utils/test_retry.py::TestRetrySync::test_retry_until_success PASSED [ 90%]
tests/unit/utils/test_retry.py::TestRetrySync::test_all_attempts_fail PASSED [ 90%]
tests/unit/utils/test_retry.py::TestRetrySync::test_non_retryable_exception PASSED [ 90%]
tests/unit/utils/test_retry.py::TestRetryDecorators::test_async_decorator PASSED [ 90%]
tests/unit/utils/test_retry.py::TestRetryDecorators::test_async_decorator_default_config PASSED [ 90%]
tests/unit/utils/test_retry.py::TestRetryDecorators::test_sync_decorator PASSED [ 90%]
tests/unit/utils/test_retry.py::TestRetryDecorators::test_sync_decorator_default_config PASSED [ 90%]
tests/unit/utils/test_retry.py::TestPredefinedConfigs::test_http_retry_config PASSED [ 90%]
tests/unit/utils/test_retry.py::TestPredefinedConfigs::test_database_retry_config PASSED [ 90%]
tests/unit/utils/test_retry.py::TestPredefinedConfigs::test_external_api_retry_config PASSED [ 90%]
tests/unit/utils/test_retry.py::TestPredefinedConfigs::test_quick_retry_config PASSED [ 90%]
tests/unit/utils/test_retry.py::TestRetryIntegration::test_realistic_api_scenario PASSED [ 90%]
tests/unit/utils/test_retry.py::TestRetryIntegration::test_mixed_retryable_exceptions PASSED [ 91%]
tests/unit/utils/test_retry.py::TestRetryIntegration::test_retry_with_circuit_breaker_simulation PASSED [ 91%]
tests/unit/utils/test_retry.py::TestRetryIntegration::test_performance_with_many_retries PASSED [ 91%]
tests/unit/utils/test_retry.py::TestEdgeCases::test_zero_max_attempts PASSED [ 91%]
tests/unit/utils/test_retry.py::TestEdgeCases::test_negative_delays PASSED [ 91%]
tests/unit/utils/test_retry.py::TestEdgeCases::test_very_large_delays PASSED [ 91%]
tests/unit/utils/test_sanitization.py::TestHtmlSanitization::test_safe_html PASSED [ 91%]
tests/unit/utils/test_sanitization.py::TestHtmlSanitization::test_dangerous_script_tags PASSED [ 91%]
tests/unit/utils/test_sanitization.py::TestHtmlSanitization::test_dangerous_attributes PASSED [ 91%]
tests/unit/utils/test_sanitization.py::TestHtmlSanitization::test_empty_input PASSED [ 91%]
tests/unit/utils/test_sanitization.py::TestHtmlSanitization::test_none_input PASSED [ 91%]
tests/unit/utils/test_sanitization.py::TestHtmlSanitization::test_custom_allowed_tags PASSED [ 91%]
tests/unit/utils/test_sanitization.py::TestHtmlSanitization::test_javascript_urls PASSED [ 91%]
tests/unit/utils/test_sanitization.py::TestHtmlSanitization::test_strip_dangerous_false PASSED [ 91%]
tests/unit/utils/test_sanitization.py::TestUrlSanitization::test_safe_urls PASSED [ 91%]
tests/unit/utils/test_sanitization.py::TestUrlSanitization::test_dangerous_javascript_urls PASSED [ 91%]
tests/unit/utils/test_sanitization.py::TestUrlSanitization::test_disallowed_schemes PASSED [ 91%]
tests/unit/utils/test_sanitization.py::TestUrlSanitization::test_empty_url PASSED [ 91%]
tests/unit/utils/test_sanitization.py::TestUrlSanitization::test_none_url PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestUrlSanitization::test_malformed_url PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestFilenameSanitization::test_safe_filename PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestFilenameSanitization::test_dangerous_characters PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestFilenameSanitization::test_directory_traversal PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestFilenameSanitization::test_long_filename PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestFilenameSanitization::test_empty_filename PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestFilenameSanitization::test_none_filename PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestFilenameSanitization::test_filename_with_spaces PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestSqlInputSanitization::test_safe_input PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestSqlInputSanitization::test_sql_injection_patterns PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestSqlInputSanitization::test_single_quotes PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestSqlInputSanitization::test_empty_input PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestSqlInputSanitization::test_none_input PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestLogOutputSanitization::test_safe_log_data PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestLogOutputSanitization::test_ansi_escape_sequences PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestLogOutputSanitization::test_control_characters PASSED [ 92%]
tests/unit/utils/test_sanitization.py::TestLogOutputSanitization::test_long_log_data PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestLogOutputSanitization::test_multiple_whitespace PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestLogOutputSanitization::test_empty_log_data PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestLogOutputSanitization::test_none_log_data PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestJsonKeySanitization::test_allowed_keys PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestJsonKeySanitization::test_no_allowed_keys PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestJsonKeySanitization::test_empty_dict PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestJsonKeySanitization::test_non_dict_input PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestSensitiveDataRemoval::test_credit_card_numbers PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestSensitiveDataRemoval::test_ssn_removal PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestSensitiveDataRemoval::test_email_removal PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestSensitiveDataRemoval::test_api_key_removal PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestSensitiveDataRemoval::test_password_fields PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestSensitiveDataRemoval::test_custom_patterns PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestSensitiveDataRemoval::test_no_sensitive_data PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestSensitiveDataRemoval::test_empty_text PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestSensitiveDataRemoval::test_none_text PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestAiPromptSanitization::test_safe_prompt PASSED [ 93%]
tests/unit/utils/test_sanitization.py::TestAiPromptSanitization::test_prompt_injection_attempts PASSED [ 94%]
tests/unit/utils/test_sanitization.py::TestAiPromptSanitization::test_system_markers PASSED [ 94%]
tests/unit/utils/test_sanitization.py::TestAiPromptSanitization::test_long_prompt PASSED [ 94%]
tests/unit/utils/test_sanitization.py::TestAiPromptSanitization::test_excessive_whitespace PASSED [ 94%]
tests/unit/utils/test_sanitization.py::TestAiPromptSanitization::test_empty_prompt PASSED [ 94%]
tests/unit/utils/test_sanitization.py::TestAiPromptSanitization::test_none_prompt PASSED [ 94%]
tests/unit/utils/test_sanitization_comprehensive.py::TestHtmlSanitizationComprehensive::test_all_dangerous_tags_removed PASSED [ 94%]
tests/unit/utils/test_sanitization_comprehensive.py::TestHtmlSanitizationComprehensive::test_all_dangerous_attributes_removed PASSED [ 94%]
tests/unit/utils/test_sanitization_comprehensive.py::TestHtmlSanitizationComprehensive::test_all_xss_patterns_removed PASSED [ 94%]
tests/unit/utils/test_sanitization_comprehensive.py::TestHtmlSanitizationComprehensive::test_custom_allowed_tags_enforcement PASSED [ 94%]
tests/unit/utils/test_sanitization_comprehensive.py::TestHtmlSanitizationComprehensive::test_custom_allowed_attributes_enforcement PASSED [ 94%]
tests/unit/utils/test_sanitization_comprehensive.py::TestHtmlSanitizationComprehensive::test_strip_dangerous_false_behavior PASSED [ 94%]
tests/unit/utils/test_sanitization_comprehensive.py::TestHtmlSanitizationComprehensive::test_bleach_clean_parameters PASSED [ 94%]
tests/unit/utils/test_sanitization_comprehensive.py::TestHtmlSanitizationComprehensive::test_exception_handling_with_fallback PASSED [ 94%]
tests/unit/utils/test_sanitization_comprehensive.py::TestHtmlSanitizationComprehensive::test_nested_dangerous_tags PASSED [ 94%]
tests/unit/utils/test_sanitization_comprehensive.py::TestHtmlSanitizationComprehensive::test_malformed_html_handling PASSED [ 94%]
tests/unit/utils/test_sanitization_comprehensive.py::TestUrlSanitizationComprehensive::test_all_dangerous_schemes_blocked PASSED [ 94%]
tests/unit/utils/test_sanitization_comprehensive.py::TestUrlSanitizationComprehensive::test_allowed_schemes_parameter PASSED [ 94%]
tests/unit/utils/test_sanitization_comprehensive.py::TestUrlSanitizationComprehensive::test_url_parsing_edge_cases PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestUrlSanitizationComprehensive::test_url_encoding_attacks PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestUrlSanitizationComprehensive::test_data_url_variations PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestUrlSanitizationComprehensive::test_url_exception_handling PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestFilenameSanitizationComprehensive::test_all_dangerous_characters_removed PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestFilenameSanitizationComprehensive::test_directory_traversal_prevention PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestFilenameSanitizationComprehensive::test_filename_length_handling PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestFilenameSanitizationComprehensive::test_special_filenames PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestFilenameSanitizationComprehensive::test_unicode_filenames PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestFilenameSanitizationComprehensive::test_windows_reserved_names PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSqlInputSanitizationComprehensive::test_all_sql_injection_patterns PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSqlInputSanitizationComprehensive::test_comment_removal PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSqlInputSanitizationComprehensive::test_quote_escaping_comprehensive PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSqlInputSanitizationComprehensive::test_case_insensitive_pattern_matching PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestLogOutputSanitizationComprehensive::test_all_ansi_escape_sequences PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestLogOutputSanitizationComprehensive::test_all_control_characters PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestLogOutputSanitizationComprehensive::test_whitespace_normalization_comprehensive PASSED [ 95%]
tests/unit/utils/test_sanitization_comprehensive.py::TestLogOutputSanitizationComprehensive::test_truncation_behavior PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestLogOutputSanitizationComprehensive::test_unicode_in_logs PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestJsonKeySanitizationComprehensive::test_allowed_keys_filtering PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestJsonKeySanitizationComprehensive::test_empty_allowed_keys PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestJsonKeySanitizationComprehensive::test_nested_dict_handling PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestJsonKeySanitizationComprehensive::test_various_value_types PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSensitiveDataRemovalComprehensive::test_credit_card_patterns PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSensitiveDataRemovalComprehensive::test_ssn_patterns PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSensitiveDataRemovalComprehensive::test_email_patterns PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSensitiveDataRemovalComprehensive::test_api_key_patterns PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSensitiveDataRemovalComprehensive::test_password_field_patterns PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSensitiveDataRemovalComprehensive::test_custom_patterns_functionality PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSensitiveDataRemovalComprehensive::test_multiple_sensitive_data PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestAiPromptSanitizationComprehensive::test_all_dangerous_patterns PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestAiPromptSanitizationComprehensive::test_case_insensitive_filtering PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestAiPromptSanitizationComprehensive::test_prompt_length_limits PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestAiPromptSanitizationComprehensive::test_whitespace_handling PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestAiPromptSanitizationComprehensive::test_combined_attack_patterns PASSED [ 96%]
tests/unit/utils/test_sanitization_comprehensive.py::TestAiPromptSanitizationComprehensive::test_unicode_in_prompts PASSED [ 97%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSanitizeStringComprehensive::test_string_sanitization_modes PASSED [ 97%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSanitizeStringComprehensive::test_max_length_enforcement PASSED [ 97%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSanitizeStringComprehensive::test_control_character_removal PASSED [ 97%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSanitizeStringComprehensive::test_html_escaping_when_not_allowed PASSED [ 97%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSanitizeStringComprehensive::test_combined_sanitization PASSED [ 97%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSanitizeDictComprehensive::test_recursive_dict_sanitization PASSED [ 97%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSanitizeDictComprehensive::test_list_in_dict_sanitization PASSED [ 97%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSanitizeDictComprehensive::test_key_sanitization PASSED [ 97%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSanitizeDictComprehensive::test_length_limits PASSED [ 97%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSanitizeDictComprehensive::test_non_string_value_preservation PASSED [ 97%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSanitizeDictComprehensive::test_empty_key_handling PASSED [ 97%]
tests/unit/utils/test_sanitization_comprehensive.py::TestSanitizeDictComprehensive::test_html_mode_in_dict PASSED [ 97%]
tests/unit/utils/test_validation.py::TestValidationResult::test_validation_result_creation PASSED [ 97%]
tests/unit/utils/test_validation.py::TestValidationResult::test_validation_result_with_data PASSED [ 97%]
tests/unit/utils/test_validation.py::TestEmailValidation::test_valid_email PASSED [ 97%]
tests/unit/utils/test_validation.py::TestEmailValidation::test_invalid_email PASSED [ 97%]
tests/unit/utils/test_validation.py::TestEmailValidation::test_email_too_long PASSED [ 98%]
tests/unit/utils/test_validation.py::TestEmailValidation::test_empty_email PASSED [ 98%]
tests/unit/utils/test_validation.py::TestEmailValidation::test_non_string_email PASSED [ 98%]
tests/unit/utils/test_validation.py::TestUrlValidation::test_valid_urls PASSED [ 98%]
tests/unit/utils/test_validation.py::TestUrlValidation::test_invalid_urls PASSED [ 98%]
tests/unit/utils/test_validation.py::TestUrlValidation::test_url_with_custom_schemes PASSED [ 98%]
tests/unit/utils/test_validation.py::TestUrlValidation::test_non_string_url PASSED [ 98%]
tests/unit/utils/test_validation.py::TestIpValidation::test_valid_ipv4 PASSED [ 98%]
tests/unit/utils/test_validation.py::TestIpValidation::test_invalid_ipv4 PASSED [ 98%]
tests/unit/utils/test_validation.py::TestIpValidation::test_non_string_ip PASSED [ 98%]
tests/unit/utils/test_validation.py::TestSqlInjectionCheck::test_safe_input PASSED [ 98%]
tests/unit/utils/test_validation.py::TestSqlInjectionCheck::test_sql_injection_patterns PASSED [ 98%]
tests/unit/utils/test_validation.py::TestSqlInjectionCheck::test_empty_input PASSED [ 98%]
tests/unit/utils/test_validation.py::TestSqlInjectionCheck::test_none_input PASSED [ 98%]
tests/unit/utils/test_validation.py::TestXssCheck::test_safe_input PASSED [ 98%]
tests/unit/utils/test_validation.py::TestXssCheck::test_xss_patterns PASSED [ 98%]
tests/unit/utils/test_validation.py::TestPromptInjectionCheck::test_safe_prompts PASSED [ 98%]
tests/unit/utils/test_validation.py::TestPromptInjectionCheck::test_prompt_injection_patterns PASSED [ 98%]
tests/unit/utils/test_validation.py::TestJsonPayloadValidation::test_simple_payload PASSED [ 99%]
tests/unit/utils/test_validation.py::TestJsonPayloadValidation::test_deep_nesting PASSED [ 99%]
tests/unit/utils/test_validation.py::TestJsonPayloadValidation::test_too_many_keys PASSED [ 99%]
tests/unit/utils/test_validation.py::TestJsonPayloadValidation::test_list_payload PASSED [ 99%]
tests/unit/utils/test_validation.py::TestJsonPayloadValidation::test_string_payload PASSED [ 99%]
tests/unit/utils/test_validation.py::TestInputLengthValidation::test_valid_length PASSED [ 99%]
tests/unit/utils/test_validation.py::TestInputLengthValidation::test_too_short PASSED [ 99%]
tests/unit/utils/test_validation.py::TestInputLengthValidation::test_too_long PASSED [ 99%]
tests/unit/utils/test_validation.py::TestInputLengthValidation::test_near_limit_warning PASSED [ 99%]
tests/unit/utils/test_validation.py::TestInputLengthValidation::test_none_input PASSED [ 99%]
tests/unit/utils/test_validation.py::TestInputLengthValidation::test_non_string_input PASSED [ 99%]
tests/unit/utils/test_validation.py::TestComprehensiveValidation::test_safe_input PASSED [ 99%]
tests/unit/utils/test_validation.py::TestComprehensiveValidation::test_input_with_sql_injection PASSED [ 99%]
tests/unit/utils/test_validation.py::TestComprehensiveValidation::test_input_with_xss PASSED [ 99%]
tests/unit/utils/test_validation.py::TestComprehensiveValidation::test_input_with_prompt_injection PASSED [ 99%]
tests/unit/utils/test_validation.py::TestComprehensiveValidation::test_too_long_input PASSED [ 99%]
tests/unit/utils/test_validation.py::TestComprehensiveValidation::test_selective_checks PASSED [ 99%]
tests/unit/utils/test_validation.py::TestComprehensiveValidation::test_custom_field_name PASSED [100%]

==================================== ERRORS ====================================
_ ERROR at setup of TestGitHistoryParserSecurity.test_malicious_commit_messages _
file /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/test_git_history_parser_comprehensive.py, line 215
      def test_malicious_commit_messages(self, real_repo):
E       fixture 'real_repo' not found
>       available fixtures: _class_event_loop, _function_event_loop, _module_event_loop, _package_event_loop, _session_event_loop, _session_faker, admin_token, admin_user, anyio_backend, anyio_backend_name, anyio_backend_options, app, async_client, auth_token, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, class_mocker, clean_database, clean_db_session, client, cov, db_session, doctest_namespace, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, fresh_admin_token, fresh_admin_user, fresh_user, fresh_user_token, httpx_mock, include_metadata_in_junit_xml, json_metadata, metadata, mocker, module_mocker, monkeypatch, no_cover, non_mocked_hosts, package_mocker, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, reset_dependency_overrides, session_mocker, test_db_manager, test_settings, test_user, testrun_uid, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory, worker_id
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/test_git_history_parser_comprehensive.py:215
__ ERROR at setup of TestGitHistoryParserErrorHandling.test_concurrent_access __
file /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/test_git_history_parser_comprehensive.py, line 319
      def test_concurrent_access(self, real_repo):
E       fixture 'real_repo' not found
>       available fixtures: _class_event_loop, _function_event_loop, _module_event_loop, _package_event_loop, _session_event_loop, _session_faker, admin_token, admin_user, anyio_backend, anyio_backend_name, anyio_backend_options, app, async_client, auth_token, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, class_mocker, clean_database, clean_db_session, client, cov, db_session, doctest_namespace, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, fresh_admin_token, fresh_admin_user, fresh_user, fresh_user_token, httpx_mock, include_metadata_in_junit_xml, json_metadata, metadata, mocker, module_mocker, monkeypatch, no_cover, non_mocked_hosts, package_mocker, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, reset_dependency_overrides, session_mocker, test_db_manager, test_settings, test_user, testrun_uid, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory, worker_id
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/test_git_history_parser_comprehensive.py:319
__ ERROR at setup of TestGitHistoryParserPerformance.test_performance_metrics __
file /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/test_git_history_parser_comprehensive.py, line 360
      def test_performance_metrics(self, real_repo):
E       fixture 'real_repo' not found
>       available fixtures: _class_event_loop, _function_event_loop, _module_event_loop, _package_event_loop, _session_event_loop, _session_faker, admin_token, admin_user, anyio_backend, anyio_backend_name, anyio_backend_options, app, async_client, auth_token, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, class_mocker, clean_database, clean_db_session, client, cov, db_session, doctest_namespace, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, fresh_admin_token, fresh_admin_user, fresh_user, fresh_user_token, httpx_mock, include_metadata_in_junit_xml, json_metadata, metadata, mocker, module_mocker, monkeypatch, no_cover, non_mocked_hosts, package_mocker, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, reset_dependency_overrides, session_mocker, test_db_manager, test_settings, test_user, testrun_uid, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory, worker_id
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/test_git_history_parser_comprehensive.py:360
_____ ERROR at setup of TestGitHistoryParserPerformance.test_memory_usage ______
file /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/test_git_history_parser_comprehensive.py, line 402
      def test_memory_usage(self, real_repo):
E       fixture 'real_repo' not found
>       available fixtures: _class_event_loop, _function_event_loop, _module_event_loop, _package_event_loop, _session_event_loop, _session_faker, admin_token, admin_user, anyio_backend, anyio_backend_name, anyio_backend_options, app, async_client, auth_token, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, class_mocker, clean_database, clean_db_session, client, cov, db_session, doctest_namespace, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, fresh_admin_token, fresh_admin_user, fresh_user, fresh_user_token, httpx_mock, include_metadata_in_junit_xml, json_metadata, metadata, mocker, module_mocker, monkeypatch, no_cover, non_mocked_hosts, package_mocker, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, reset_dependency_overrides, session_mocker, test_db_manager, test_settings, test_user, testrun_uid, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory, worker_id
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/test_git_history_parser_comprehensive.py:402
_ ERROR at setup of TestGitHistoryParserIntegration.test_integration_with_pattern_matcher _
file /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/test_git_history_parser_comprehensive.py, line 442
      def test_integration_with_pattern_matcher(self, real_repo):
E       fixture 'real_repo' not found
>       available fixtures: _class_event_loop, _function_event_loop, _module_event_loop, _package_event_loop, _session_event_loop, _session_faker, admin_token, admin_user, anyio_backend, anyio_backend_name, anyio_backend_options, app, async_client, auth_token, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, class_mocker, clean_database, clean_db_session, client, cov, db_session, doctest_namespace, event_loop, event_loop_policy, faker, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, fresh_admin_token, fresh_admin_user, fresh_user, fresh_user_token, httpx_mock, include_metadata_in_junit_xml, json_metadata, metadata, mocker, module_mocker, monkeypatch, no_cover, non_mocked_hosts, package_mocker, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, reset_dependency_overrides, session_mocker, test_db_manager, test_settings, test_user, testrun_uid, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory, worker_id
>       use 'pytest --fixtures [testpath]' for help on them.

/Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/test_git_history_parser_comprehensive.py:442
=================================== FAILURES ===================================
_______________ TestGitHistoryParser.test_parser_initialization ________________
tests/unit/test_git_history_parser.py:98: in test_parser_initialization
    parser = GitHistoryParser(Path("/test/repo"))
tools/pre_audit/git_history_parser.py:124: in __init__
    self.repo_path = self._validate_path_input(repo_path)
tools/pre_audit/git_history_parser.py:88: in _validate_path_input
    raise ValueError(f"Path does not exist: {path}")
E   ValueError: Path does not exist: /test/repo
__________ TestGitHistoryParser.test_parser_initialization_bare_repo ___________
tests/unit/test_git_history_parser.py:111: in test_parser_initialization_bare_repo
    GitHistoryParser(Path("/test/repo"))
tools/pre_audit/git_history_parser.py:124: in __init__
    self.repo_path = self._validate_path_input(repo_path)
tools/pre_audit/git_history_parser.py:88: in _validate_path_input
    raise ValueError(f"Path does not exist: {path}")
E   ValueError: Path does not exist: /test/repo

During handling of the above exception, another exception occurred:
tests/unit/test_git_history_parser.py:110: in test_parser_initialization_bare_repo
    with pytest.raises(ValueError, match="Cannot analyze bare repository"):
E   AssertionError: Regex pattern did not match.
E    Regex: 'Cannot analyze bare repository'
E    Input: 'Path does not exist: /test/repo'
________________ TestGitHistoryParser.test_parser_no_gitpython _________________
tests/unit/test_git_history_parser.py:117: in test_parser_no_gitpython
    GitHistoryParser(Path("/test/repo"))
tools/pre_audit/git_history_parser.py:124: in __init__
    self.repo_path = self._validate_path_input(repo_path)
tools/pre_audit/git_history_parser.py:88: in _validate_path_input
    raise ValueError(f"Path does not exist: {path}")
E   ValueError: Path does not exist: /test/repo
______________ TestGitHistoryParser.test_find_architectural_fixes ______________
tests/unit/test_git_history_parser.py:139: in test_find_architectural_fixes
    parser = GitHistoryParser(Path("/test/repo"))
tools/pre_audit/git_history_parser.py:124: in __init__
    self.repo_path = self._validate_path_input(repo_path)
tools/pre_audit/git_history_parser.py:88: in _validate_path_input
    raise ValueError(f"Path does not exist: {path}")
E   ValueError: Path does not exist: /test/repo
______ TestGitHistoryParser.test_find_architectural_fixes_with_adr_filter ______
tests/unit/test_git_history_parser.py:173: in test_find_architectural_fixes_with_adr_filter
    parser = GitHistoryParser(Path("/test/repo"))
tools/pre_audit/git_history_parser.py:124: in __init__
    self.repo_path = self._validate_path_input(repo_path)
tools/pre_audit/git_history_parser.py:88: in _validate_path_input
    raise ValueError(f"Path does not exist: {path}")
E   ValueError: Path does not exist: /test/repo
_____________ TestGitHistoryParser.test_find_file_change_patterns ______________
tests/unit/test_git_history_parser.py:211: in test_find_file_change_patterns
    parser = GitHistoryParser(Path("/test/repo"))
tools/pre_audit/git_history_parser.py:124: in __init__
    self.repo_path = self._validate_path_input(repo_path)
tools/pre_audit/git_history_parser.py:88: in _validate_path_input
    raise ValueError(f"Path does not exist: {path}")
E   ValueError: Path does not exist: /test/repo
________ TestGitHistoryParser.test_export_fixes_summary_invalid_format _________
tests/unit/test_git_history_parser.py:403: in test_export_fixes_summary_invalid_format
    with pytest.raises(ValueError, match="Unsupported format"):
E   Failed: DID NOT RAISE <class 'ValueError'>
_____ TestGitHistoryParserRealRepo.test_find_architectural_fixes_real_repo _____
tests/unit/test_git_history_parser_comprehensive.py:119: in test_find_architectural_fixes_real_repo
    assert "ADR-023" in adr_refs
E   AssertionError: assert 'ADR-023' in {'ADR-001'}
----------------------------- Captured stdout call -----------------------------
Popen(['git', 'cat-file', '--batch-check'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=<valid stream>, shell=False, universal_newlines=False)
Popen(['git', 'rev-list', '--since=2025-02-04 14:31:16.452895+00:00', '114c62c8e814b3d3da7c0755552d45260df4b553', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'cat-file', '--batch'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=<valid stream>, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '307e5af3d4be3e4e4f22bd30f7f92ca64a4a5f44', '114c62c8e814b3d3da7c0755552d45260df4b553', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '0b6c7b5e7e42476254d34891ba60fbb692c15980', '307e5af3d4be3e4e4f22bd30f7f92ca64a4a5f44', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', 'ef00b4bfc4fd0d1619a18a3e68591f9492e1dfa6', '0b6c7b5e7e42476254d34891ba60fbb692c15980', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', 'ce6e6586dbd0341e50b2ee25c9ad1d2f16332f72', 'ef00b4bfc4fd0d1619a18a3e68591f9492e1dfa6', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '2a5074caa4e5412e4eefaedcca8fae7b3aed9b7e', 'ce6e6586dbd0341e50b2ee25c9ad1d2f16332f72', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '8463a2bbb8d592998d6047b2987c69f34df7adeb', '2a5074caa4e5412e4eefaedcca8fae7b3aed9b7e', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff-tree', '--numstat', '--no-renames', '--root', '--raw', '8463a2bbb8d592998d6047b2987c69f34df7adeb', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
------------------------------ Captured log call -------------------------------
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'cat-file', '--batch-check'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=<valid stream>, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'rev-list', '--since=2025-02-04 14:31:16.452895+00:00', '114c62c8e814b3d3da7c0755552d45260df4b553', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'cat-file', '--batch'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=<valid stream>, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '307e5af3d4be3e4e4f22bd30f7f92ca64a4a5f44', '114c62c8e814b3d3da7c0755552d45260df4b553', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '0b6c7b5e7e42476254d34891ba60fbb692c15980', '307e5af3d4be3e4e4f22bd30f7f92ca64a4a5f44', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', 'ef00b4bfc4fd0d1619a18a3e68591f9492e1dfa6', '0b6c7b5e7e42476254d34891ba60fbb692c15980', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', 'ce6e6586dbd0341e50b2ee25c9ad1d2f16332f72', 'ef00b4bfc4fd0d1619a18a3e68591f9492e1dfa6', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '2a5074caa4e5412e4eefaedcca8fae7b3aed9b7e', 'ce6e6586dbd0341e50b2ee25c9ad1d2f16332f72', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '8463a2bbb8d592998d6047b2987c69f34df7adeb', '2a5074caa4e5412e4eefaedcca8fae7b3aed9b7e', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff-tree', '--numstat', '--no-renames', '--root', '--raw', '8463a2bbb8d592998d6047b2987c69f34df7adeb', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_find_architectural_fixes_0/test_repo, stdin=None, shell=False, universal_newlines=False)
_______ TestGitHistoryParserRealRepo.test_file_change_patterns_real_repo _______
tests/unit/test_git_history_parser_comprehensive.py:152: in test_file_change_patterns_real_repo
    assert pattern.is_architectural  # Contains 'core' or 'auth'
E   AssertionError: assert False
E    +  where False = FileChangePattern(files={'app/auth.py', 'app/models.py'}, frequency=2, commits=['113d5696', '80787d7b'], is_architectural=False).is_architectural
----------------------------- Captured stdout call -----------------------------
Popen(['git', 'cat-file', '--batch-check'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=<valid stream>, shell=False, universal_newlines=False)
Popen(['git', 'rev-list', '--since=2025-02-04 14:31:17.842596+00:00', '43bd32e274e18f30fe6cee78f39908ef66cf03df', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'cat-file', '--batch'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=<valid stream>, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', 'a6502590cac47530b659c5449b98564e6358fd27', '43bd32e274e18f30fe6cee78f39908ef66cf03df', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '113d56961ed2c4d77a07af08f4d26f64ac765d25', 'a6502590cac47530b659c5449b98564e6358fd27', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', 'f48e617502bcbe46f69b1d215d0f3047dca5cb23', '113d56961ed2c4d77a07af08f4d26f64ac765d25', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', 'f023910f284cade85b553e9d3996f595ed09c855', 'f48e617502bcbe46f69b1d215d0f3047dca5cb23', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '1358fc9fd6c6ae737dd5d2bc1195f8b897d6a5e8', 'f023910f284cade85b553e9d3996f595ed09c855', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '80787d7b041e96fabd419b8567d376d8786a1a15', '1358fc9fd6c6ae737dd5d2bc1195f8b897d6a5e8', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff-tree', '--numstat', '--no-renames', '--root', '--raw', '80787d7b041e96fabd419b8567d376d8786a1a15', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
------------------------------ Captured log call -------------------------------
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'cat-file', '--batch-check'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=<valid stream>, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'rev-list', '--since=2025-02-04 14:31:17.842596+00:00', '43bd32e274e18f30fe6cee78f39908ef66cf03df', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'cat-file', '--batch'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=<valid stream>, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', 'a6502590cac47530b659c5449b98564e6358fd27', '43bd32e274e18f30fe6cee78f39908ef66cf03df', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '113d56961ed2c4d77a07af08f4d26f64ac765d25', 'a6502590cac47530b659c5449b98564e6358fd27', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', 'f48e617502bcbe46f69b1d215d0f3047dca5cb23', '113d56961ed2c4d77a07af08f4d26f64ac765d25', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', 'f023910f284cade85b553e9d3996f595ed09c855', 'f48e617502bcbe46f69b1d215d0f3047dca5cb23', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '1358fc9fd6c6ae737dd5d2bc1195f8b897d6a5e8', 'f023910f284cade85b553e9d3996f595ed09c855', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '80787d7b041e96fabd419b8567d376d8786a1a15', '1358fc9fd6c6ae737dd5d2bc1195f8b897d6a5e8', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff-tree', '--numstat', '--no-renames', '--root', '--raw', '80787d7b041e96fabd419b8567d376d8786a1a15', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_file_change_patterns_real0/test_repo, stdin=None, shell=False, universal_newlines=False)
____________ TestGitHistoryParserRealRepo.test_statistics_real_repo ____________
tests/unit/test_git_history_parser_comprehensive.py:167: in test_statistics_real_repo
    assert len(stats["adr_references"]) >= 2
E   AssertionError: assert 1 >= 2
E    +  where 1 = len({'ADR-001': 1})
----------------------------- Captured stdout call -----------------------------
Popen(['git', 'cat-file', '--batch-check'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=<valid stream>, shell=False, universal_newlines=False)
Popen(['git', 'rev-list', '--since=2025-02-04 14:31:18.535144+00:00', 'c5f9ea94e8cd235dac2b6b3c2a936c0deeeb1a6a', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'cat-file', '--batch'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=<valid stream>, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '8ee891bc0ad0cba20a3db484e6989a4dfeb8b9e5', 'c5f9ea94e8cd235dac2b6b3c2a936c0deeeb1a6a', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '7d3cecaeb014672dccd2d3cd8193c88fc940a035', '8ee891bc0ad0cba20a3db484e6989a4dfeb8b9e5', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '4505e22dbdc95d85c10bbf8167c78f663269f18c', '7d3cecaeb014672dccd2d3cd8193c88fc940a035', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', 'ed85c748cf345ac4454f1a2f0c91f1dc1bc284d2', '4505e22dbdc95d85c10bbf8167c78f663269f18c', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '41d73fdb45e16f2faed9a1fc26e8b891fa4e3e35', 'ed85c748cf345ac4454f1a2f0c91f1dc1bc284d2', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '24cef7dcfd41721e483fb89d1597d069e1b266ad', '41d73fdb45e16f2faed9a1fc26e8b891fa4e3e35', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
Popen(['git', 'diff-tree', '--numstat', '--no-renames', '--root', '--raw', '24cef7dcfd41721e483fb89d1597d069e1b266ad', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
------------------------------ Captured log call -------------------------------
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'cat-file', '--batch-check'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=<valid stream>, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'rev-list', '--since=2025-02-04 14:31:18.535144+00:00', 'c5f9ea94e8cd235dac2b6b3c2a936c0deeeb1a6a', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'cat-file', '--batch'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=<valid stream>, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '8ee891bc0ad0cba20a3db484e6989a4dfeb8b9e5', 'c5f9ea94e8cd235dac2b6b3c2a936c0deeeb1a6a', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '7d3cecaeb014672dccd2d3cd8193c88fc940a035', '8ee891bc0ad0cba20a3db484e6989a4dfeb8b9e5', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '4505e22dbdc95d85c10bbf8167c78f663269f18c', '7d3cecaeb014672dccd2d3cd8193c88fc940a035', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', 'ed85c748cf345ac4454f1a2f0c91f1dc1bc284d2', '4505e22dbdc95d85c10bbf8167c78f663269f18c', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '41d73fdb45e16f2faed9a1fc26e8b891fa4e3e35', 'ed85c748cf345ac4454f1a2f0c91f1dc1bc284d2', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff', '--numstat', '--no-renames', '--raw', '24cef7dcfd41721e483fb89d1597d069e1b266ad', '41d73fdb45e16f2faed9a1fc26e8b891fa4e3e35', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
DEBUG    git.cmd:cmd.py:1253 Popen(['git', 'diff-tree', '--numstat', '--no-renames', '--root', '--raw', '24cef7dcfd41721e483fb89d1597d069e1b266ad', '--'], cwd=/private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_statistics_real_repo0/test_repo, stdin=None, shell=False, universal_newlines=False)
___________ TestGitHistoryParserErrorHandling.test_empty_repository ____________
tests/unit/test_git_history_parser_comprehensive.py:290: in test_empty_repository
    fixes = parser.find_architectural_fixes()
tools/pre_audit/git_history_parser.py:165: in find_architectural_fixes
    commits = list(self.repo.iter_commits(since=since_date))
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/git/repo/base.py:787: in iter_commits
    rev = self.head.commit
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/git/refs/symbolic.py:297: in _get_commit
    obj = self._get_object()
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/git/refs/symbolic.py:288: in _get_object
    return Object.new_from_sha(self.repo, hex_to_bin(self.dereference_recursive(self.repo, self.path)))
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/git/refs/symbolic.py:168: in dereference_recursive
    hexsha, ref_path = cls._get_ref_info(repo, ref_path)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/git/refs/symbolic.py:278: in _get_ref_info
    return cls._get_ref_info_helper(repo, ref_path)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/git/refs/symbolic.py:257: in _get_ref_info_helper
    raise ValueError("Reference at %r does not exist" % ref_path)
E   ValueError: Reference at 'refs/heads/main' does not exist
___________ TestGitHistoryParserErrorHandling.test_permission_errors ___________
tools/pre_audit/git_history_parser.py:132: in __init__
    self.repo = git.Repo(repo_path)
/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/git/repo/base.py:289: in __init__
    raise InvalidGitRepositoryError(epath)
E   git.exc.InvalidGitRepositoryError: /private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_permission_errors0/restricted_repo

During handling of the above exception, another exception occurred:
tests/unit/test_git_history_parser_comprehensive.py:311: in test_permission_errors
    parser = GitHistoryParser(repo_path)
tools/pre_audit/git_history_parser.py:136: in __init__
    raise ValueError(f"Invalid git repository at {repo_path}: {e}")
E   ValueError: Invalid git repository at /private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_permission_errors0/restricted_repo: /private/var/folders/dx/q9229th15tq2n0grk92tb_7r0000gn/T/pytest-of-tamnguyen/pytest-25/test_permission_errors0/restricted_repo
__________ TestPatternMatcherRobustness.test_adr_reference_edge_cases __________
tests/unit/test_git_pattern_matcher_comprehensive.py:167: in test_adr_reference_edge_cases
    assert sorted(refs) == sorted(expected), f"Failed for '{text}': got {refs}"
E   AssertionError: Failed for 'ADR-00001': got ['ADR-0000']
E   assert ['ADR-0000'] == ['ADR-00001']
E
E     At index 0 diff: 'ADR-0000' != 'ADR-00001'
E
E     Full diff:
E       [
E     -     'ADR-00001',
E     ?              -
E     +     'ADR-0000',
E       ]
______ TestPatternMatcherRobustness.test_confidence_calculation_accuracy _______
tests/unit/test_git_pattern_matcher_comprehensive.py:216: in test_confidence_calculation_accuracy
    assert max(confidences) <= max_conf, \
E   AssertionError: Confidence too high for 'Fix architectural violation': 0.99
E   assert 0.99 <= 0.95
E    +  where 0.99 = max([0.99])
=============================== warnings summary ===============================
../../../../../Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/passlib/utils/__init__.py:854
  /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/passlib/utils/__init__.py:854: DeprecationWarning: 'crypt' is deprecated and slated for removal in Python 3.13
    from crypt import crypt as _crypt

../../../../../Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
../../../../../Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
../../../../../Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pydantic/_internal/_config.py:291
  /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pydantic/_internal/_config.py:291: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

app/schemas/oauth.py:23
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/schemas/oauth.py:23: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("application_type")

app/schemas/oauth.py:30
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/schemas/oauth.py:30: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("redirect_uris")

app/schemas/oauth.py:41
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/schemas/oauth.py:41: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("allowed_scopes")

../../../../../Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:312
../../../../../Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:312
../../../../../Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:312
../../../../../Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:312
  /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pydantic/_internal/_generate_schema.py:312: PydanticDeprecatedSince20: `json_encoders` is deprecated. See https://docs.pydantic.dev/2.9/concepts/serialization/#custom-serializers for alternatives. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    warnings.warn(

app/schemas/oauth.py:135
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/schemas/oauth.py:135: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("response_type")

app/schemas/oauth.py:142
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/schemas/oauth.py:142: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("code_challenge_method")

app/schemas/oauth.py:162
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/schemas/oauth.py:162: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("grant_type")

app/schemas/oauth.py:188
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/schemas/oauth.py:188: PydanticDeprecatedSince20: Pydantic V1 style `@validator` validators are deprecated. You should migrate to Pydantic V2 style `@field_validator` validators, see the migration guide for more details. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.9/migration/
    @validator("token_type_hint")

tests/unit/core/test_external_services.py:31
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/core/test_external_services.py:31: PytestCollectionWarning: cannot collect test class 'TestServiceResponse' because it has a __init__ constructor (from: tests/unit/core/test_external_services.py)
    class TestServiceResponse(BaseModel):

../../../../../Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlalchemy/orm/decl_api.py:0
  /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlalchemy/orm/decl_api.py:0: PytestCollectionWarning: cannot collect test class 'Base' because it has a __init__ constructor (from: tests/unit/models/test_mixins.py)

tests/unit/models/test_mixins.py:26
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/models/test_mixins.py:26: PytestCollectionWarning: cannot collect test class 'TestModel' because it has a __init__ constructor (from: tests/unit/models/test_mixins.py)
    class TestModel(TestBase, BaseModelMixin):

tests/unit/test_errors.py:32
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/test_errors.py:32: PytestCollectionWarning: cannot collect test class 'TestModel' because it has a __init__ constructor (from: tests/unit/test_errors.py)
    class TestModel(BaseModel):

tests/unit/api/test_api_keys.py::TestAPIKeyEndpoints::test_list_api_keys
  /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/passlib/handlers/argon2.py:716: DeprecationWarning: Accessing argon2.__version__ is deprecated and will be removed in a future release. Use importlib.metadata directly to query for structlog's packaging metadata.
    _argon2_cffi.__version__, max_version)

tests/unit/api/test_api_keys.py: 11 warnings
tests/unit/api/test_audit_logs.py: 8 warnings
tests/unit/api/test_sessions.py: 11 warnings
tests/unit/api/test_users.py: 12 warnings
tests/unit/schemas/test_common_comprehensive.py: 10 warnings
  /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/pydantic/main.py:212: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)

tests/unit/core/test_external_services.py: 4 warnings
tests/unit/db/test_database_session_comprehensive.py: 1 warning
tests/unit/db/test_db_session_comprehensive.py: 1 warning
tests/unit/db/test_unit_db_session.py: 1 warning
tests/unit/test_errors.py: 2 warnings
tests/unit/utils/test_circuit_breaker.py: 13 warnings
tests/unit/utils/test_retry.py: 16 warnings
  /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/structlog/_base.py:165: UserWarning: Remove `format_exc_info` from your processor chain if you want pretty exceptions.
    event_dict = proc(self._logger, method_name, event_dict)

tests/unit/db/test_unit_db_session.py::TestDatabaseShutdown::test_close_database_connections_success
tests/unit/db/test_unit_db_session.py::TestDatabaseShutdown::test_close_database_connections_resets_global
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/db/session.py:220: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    pool_stats = get_connection_pool_stats()
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/unit/middleware/test_csrf_advanced_security.py: 48 warnings
tests/unit/middleware/test_csrf_middleware.py: 4 warnings
tests/unit/middleware/test_csrf_middleware_comprehensive.py: 2 warnings
tests/unit/middleware/test_session_middleware.py: 4 warnings
  /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/starlette/testclient.py:451: DeprecationWarning: Setting per-request cookies=<...> is being deprecated, because the expected behaviour on cookie persistence is ambiguous. Set cookies directly on the client instance instead.
    return super().request(

tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_invalid_json_rejected
tests/unit/middleware/test_input_sanitization_middleware.py::TestInputSanitizationMiddleware::test_content_type_handling
  /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/httpx/_models.py:408: DeprecationWarning: Use 'content=<...>' to upload raw bytes/text content.
    headers, stream = encode_request(

tests/unit/middleware/test_request_signing_middleware.py::TestRequestSigner::test_signature_verification
  /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/_pytest/python.py:159: RuntimeWarning: coroutine 'RequestSigningMiddleware._verify_signature' was never awaited
    result = testfunction(**testargs)
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareDispatch::test_dispatch_session_deletion
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareDispatch::test_dispatch_session_rotation
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareDispatch::test_dispatch_rotation_failure
tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareIntegration::test_concurrent_session_operations
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/middleware/session.py:57: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    if session_data.get("rotation_recommended"):
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/unit/middleware/test_session_middleware_comprehensive.py::TestSessionMiddlewareCookieHandling::test_clear_session_cookie
  /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:472: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    __dict__['method_calls'] = _CallList()
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/unit/models/test_api_key_comprehensive.py::TestAPIKeyValidations::test_validate_description_calls_security_validation
  /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/sqlalchemy/orm/mapper.py:4395: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    def _event_on_init(state, args, kwargs):
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

tests/unit/schemas/test_common_comprehensive.py::TestErrorResponse::test_error_response_auto_timestamp
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/schemas/test_common_comprehensive.py:49: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    before = datetime.utcnow()

tests/unit/schemas/test_common_comprehensive.py::TestErrorResponse::test_error_response_auto_timestamp
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/schemas/test_common_comprehensive.py:51: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    after = datetime.utcnow()

tests/unit/schemas/test_common_comprehensive.py::TestErrorResponse::test_error_response_from_dict
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/schemas/test_common_comprehensive.py:79: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "timestamp": datetime.utcnow(),

tests/unit/schemas/test_common_comprehensive.py::TestHealthResponse::test_health_response_unhealthy
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/schemas/test_common_comprehensive.py:165: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    status="unhealthy", timestamp=datetime.utcnow(), service="test-service", version="0.1.0"

tests/unit/schemas/test_common_comprehensive.py::TestHealthResponse::test_health_response_required_fields
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/schemas/test_common_comprehensive.py:174: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    HealthResponse(timestamp=datetime.utcnow(), service="test", version="1.0")

tests/unit/schemas/test_common_comprehensive.py::TestHealthResponse::test_health_response_required_fields
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/schemas/test_common_comprehensive.py:182: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    HealthResponse(status="healthy", timestamp=datetime.utcnow(), version="1.0")

tests/unit/schemas/test_common_comprehensive.py::TestHealthResponse::test_health_response_required_fields
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/schemas/test_common_comprehensive.py:186: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    HealthResponse(status="healthy", timestamp=datetime.utcnow(), service="test")

tests/unit/schemas/test_common_comprehensive.py::TestHealthResponse::test_health_response_various_statuses
tests/unit/schemas/test_common_comprehensive.py::TestHealthResponse::test_health_response_various_statuses
tests/unit/schemas/test_common_comprehensive.py::TestHealthResponse::test_health_response_various_statuses
tests/unit/schemas/test_common_comprehensive.py::TestHealthResponse::test_health_response_various_statuses
tests/unit/schemas/test_common_comprehensive.py::TestHealthResponse::test_health_response_various_statuses
tests/unit/schemas/test_common_comprehensive.py::TestHealthResponse::test_health_response_various_statuses
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/schemas/test_common_comprehensive.py:193: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    health = HealthResponse(status=status, timestamp=datetime.utcnow(), service="test", version="1.0")

tests/unit/services/test_audit_service.py::TestAuditService::test_get_user_activity
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/services/test_audit_service.py:310: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    MagicMock(spec=AuditLog, action="user.login", created_at=datetime.utcnow()),

tests/unit/services/test_audit_service.py::TestAuditService::test_get_user_activity
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/services/test_audit_service.py:311: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    MagicMock(spec=AuditLog, action="user.update", created_at=datetime.utcnow()),

tests/unit/services/test_audit_service.py::TestAuditService::test_get_user_activity
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/services/test_audit_service.py:321: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    start_date=datetime.utcnow() - timedelta(days=7),

tests/unit/services/test_audit_service.py::TestAuditService::test_get_failed_auth_attempts
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/audit_service.py:492: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    since = datetime.utcnow() - time_window

tests/unit/services/test_audit_service.py::TestAuditService::test_cleanup_old_logs
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/audit_service.py:762: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    cutoff_date = datetime.utcnow() - timedelta(days=retention_days)

tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_policy_conditions_roles
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_policy_conditions_superuser
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_policy_conditions_account_age
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_mfa_requirement_no_policies
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_mfa_requirement_required_policy
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_mfa_requirement_grace_period
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/services/test_mfa_policy_service.py:38: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    user.created_at = datetime.utcnow() - timedelta(days=30)

tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_policy_conditions_account_age
tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_policy_conditions_account_age
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/mfa_policy_service.py:139: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    account_age = datetime.utcnow() - user.created_at

tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_mfa_requirement_grace_period
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/services/test_mfa_policy_service.py:201: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    mock_user.created_at = datetime.utcnow() - timedelta(days=5)  # 5 days old account

tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_check_mfa_requirement_grace_period
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/mfa_policy_service.py:194: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    account_age = datetime.utcnow() - user.created_at

tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_update_policy_success
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/mfa_policy_service.py:263: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    policy.updated_at = datetime.utcnow()

tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_delete_policy_success
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/mfa_policy_service.py:287: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    policy.updated_at = datetime.utcnow()

tests/unit/services/test_mfa_policy_service.py::TestMFAPolicyService::test_list_policies_success
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/services/test_mfa_policy_service.py:279: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    policy1.created_at = datetime.utcnow()

tests/unit/services/test_mfa_service.py::TestMFAService::test_setup_totp_existing_verified_device
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/services/test_mfa_service.py:97: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    existing_device.verified_at = datetime.utcnow()

tests/unit/services/test_mfa_service.py::TestMFAService::test_verify_totp_setup_success
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/mfa_service.py:128: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    device.verified_at = datetime.utcnow()

tests/unit/services/test_mfa_service.py::TestMFAService::test_create_mfa_challenge_success
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/mfa_service.py:175: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    expires_at=datetime.utcnow() + timedelta(minutes=self.CHALLENGE_EXPIRY_MINUTES),

tests/unit/services/test_mfa_service.py::TestMFAService::test_verify_mfa_challenge_totp_success
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/mfa_service.py:235: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    challenge.verified_at = datetime.utcnow()

tests/unit/services/test_mfa_service.py::TestMFAService::test_verify_mfa_challenge_totp_success
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/mfa_service.py:238: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    device.last_used_at = datetime.utcnow()

tests/unit/services/test_mfa_service.py::TestMFAService::test_remove_mfa_device_success
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/mfa_service.py:300: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    device.deleted_at = datetime.utcnow()

tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_create_authorization_code
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/oauth_service.py:229: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    expires_at = datetime.utcnow() + timedelta(minutes=self.AUTHORIZATION_CODE_EXPIRE_MINUTES)

tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_exchange_authorization_code_success
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_exchange_authorization_code_with_pkce
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/oauth_service.py:339: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    auth_code.used_at = datetime.utcnow()

tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_refresh_access_token_success
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_refresh_access_token_scope_reduction
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/oauth_service.py:415: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    refresh_token_obj.last_used_at = datetime.utcnow()

tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_revoke_token_access_token
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/oauth_service.py:516: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    access_token.revoked_at = datetime.utcnow()

tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_revoke_token_refresh_token
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/oauth_service.py:542: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    refresh_token.revoked_at = datetime.utcnow()

tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_revoke_token_refresh_token
tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_revoke_token_refresh_token
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/oauth_service.py:550: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    access_token.revoked_at = datetime.utcnow()

tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_list_user_authorizations
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/services/test_oauth_service.py:559: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    mock_token.created_at = datetime.utcnow()

tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_list_user_authorizations
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/services/test_oauth_service.py:560: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    mock_token.last_used_at = datetime.utcnow()

tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_list_user_authorizations
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/oauth_service.py:579: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    OAuthRefreshToken.expires_at > datetime.utcnow(),

tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_revoke_user_authorization
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/oauth_service.py:627: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    token.revoked_at = datetime.utcnow()

tests/unit/services/test_oauth_service.py::TestOAuth2Service::test_revoke_user_authorization
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/services/oauth_service.py:640: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    token.revoked_at = datetime.utcnow()

tests/unit/test_auth_failover.py::TestCacheManager::test_cache_fallback_when_redis_unavailable
tests/unit/test_auth_failover.py::TestCacheManager::test_cache_fallback_when_redis_unavailable
tests/unit/test_auth_failover.py::TestCacheManager::test_cache_pattern_matching
tests/unit/test_auth_failover.py::TestCacheManager::test_cache_pattern_matching
tests/unit/test_auth_failover.py::TestCacheManager::test_cache_pattern_matching
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/core/cache.py:434: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    expires_at = datetime.utcnow() + timedelta(seconds=ttl) if ttl > 0 else None

tests/unit/test_auth_failover.py::TestCacheManager::test_cache_fallback_when_redis_unavailable
tests/unit/test_auth_failover.py::TestCacheManager::test_cache_pattern_matching
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/core/cache.py:123: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    if cache_entry["expires_at"] and cache_entry["expires_at"] < datetime.utcnow():

tests/unit/test_auth_failover.py::TestCircuitBreaker::test_circuit_breaker_opens_after_failures
tests/unit/test_auth_failover.py::TestCircuitBreaker::test_circuit_breaker_half_open_recovery
tests/unit/test_auth_failover.py::TestFallbackAuthProvider::test_authenticate_with_fallback_primary_fails
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/core/circuit_breaker.py:75: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    self._last_state_change: datetime = datetime.utcnow()

tests/unit/test_auth_failover.py::TestCircuitBreaker::test_circuit_breaker_opens_after_failures
tests/unit/test_auth_failover.py::TestCircuitBreaker::test_circuit_breaker_opens_after_failures
tests/unit/test_auth_failover.py::TestCircuitBreaker::test_circuit_breaker_opens_after_failures
tests/unit/test_auth_failover.py::TestCircuitBreaker::test_circuit_breaker_half_open_recovery
tests/unit/test_auth_failover.py::TestCircuitBreaker::test_circuit_breaker_half_open_recovery
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/core/circuit_breaker.py:201: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    self._last_failure_time = datetime.utcnow()

tests/unit/test_auth_failover.py::TestCircuitBreaker::test_circuit_breaker_opens_after_failures
tests/unit/test_auth_failover.py::TestCircuitBreaker::test_circuit_breaker_half_open_recovery
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/core/circuit_breaker.py:231: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    self._last_state_change = datetime.utcnow()

tests/unit/test_auth_failover.py::TestCircuitBreaker::test_circuit_breaker_opens_after_failures
tests/unit/test_auth_failover.py::TestCircuitBreaker::test_circuit_breaker_half_open_recovery
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/core/circuit_breaker.py:171: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    time_since_failure = datetime.utcnow() - self._last_failure_time

tests/unit/test_auth_failover.py::TestCircuitBreaker::test_circuit_breaker_half_open_recovery
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/core/circuit_breaker.py:242: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    self._last_state_change = datetime.utcnow()

tests/unit/test_auth_failover.py::TestCircuitBreaker::test_circuit_breaker_half_open_recovery
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/core/circuit_breaker.py:220: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    self._last_state_change = datetime.utcnow()

tests/unit/test_auth_failover.py::TestFallbackAuthProvider::test_cache_user_credentials
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/core/auth_failover.py:63: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "cached_at": datetime.utcnow().isoformat(),

tests/unit/test_auth_failover.py::TestFallbackAuthProvider::test_create_emergency_token
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/core/auth_failover.py:239: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    expires_at = datetime.utcnow() + duration

tests/unit/test_auth_failover.py::TestFallbackAuthProvider::test_create_emergency_token
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/core/auth_failover.py:246: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "created_at": datetime.utcnow(),

tests/unit/test_auth_failover.py::TestFallbackAuthProvider::test_create_emergency_token
tests/unit/test_auth_failover.py::TestFallbackAuthProvider::test_emergency_token_expiration
  /Users/tamnguyen/Documents/GitHub/violentutf-api/app/core/auth_failover.py:299: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    if expires_at <= datetime.utcnow():

tests/unit/test_auth_failover.py::TestFallbackAuthProvider::test_emergency_token_expiration
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/test_auth_failover.py:248: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    "expires_at": datetime.utcnow() - timedelta(hours=1),

tests/unit/test_enhanced_filtering.py::TestEnhancedFilter::test_enhanced_filter_with_date_range
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/test_enhanced_filtering.py:202: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow()

tests/unit/test_enhanced_filtering.py::TestComplexFilteringScenarios::test_complex_user_search_scenario
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/test_enhanced_filtering.py:384: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    created_after=datetime.utcnow() - timedelta(days=30),

tests/unit/test_enhanced_filtering.py::TestComplexFilteringScenarios::test_audit_log_filtering_scenario
  /Users/tamnguyen/Documents/GitHub/violentutf-api/tests/unit/test_enhanced_filtering.py:410: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
    now = datetime.utcnow()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_parser_initialization
FAILED tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_parser_initialization_bare_repo
FAILED tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_parser_no_gitpython
FAILED tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_find_architectural_fixes
FAILED tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_find_architectural_fixes_with_adr_filter
FAILED tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_find_file_change_patterns
FAILED tests/unit/test_git_history_parser.py::TestGitHistoryParser::test_export_fixes_summary_invalid_format
FAILED tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserRealRepo::test_find_architectural_fixes_real_repo
FAILED tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserRealRepo::test_file_change_patterns_real_repo
FAILED tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserRealRepo::test_statistics_real_repo
FAILED tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserErrorHandling::test_empty_repository
FAILED tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserErrorHandling::test_permission_errors
FAILED tests/unit/test_git_pattern_matcher_comprehensive.py::TestPatternMatcherRobustness::test_adr_reference_edge_cases
FAILED tests/unit/test_git_pattern_matcher_comprehensive.py::TestPatternMatcherRobustness::test_confidence_calculation_accuracy
ERROR tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserSecurity::test_malicious_commit_messages
ERROR tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserErrorHandling::test_concurrent_access
ERROR tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserPerformance::test_performance_metrics
ERROR tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserPerformance::test_memory_usage
ERROR tests/unit/test_git_history_parser_comprehensive.py::TestGitHistoryParserIntegration::test_integration_with_pattern_matcher
= 14 failed, 1734 passed, 5 skipped, 1 deselected, 260 warnings, 5 errors in 36.74s =

Validate YAML (matches CI)...............................................Passed
Validate JSON (matches CI)...............................................Passed
🏛️ Architectural Compliance Check (Smart Triggers).......................Passed
Check for hardcoded secrets..............................................Passed
Check for print statements...............................................Passed
Check API security patterns..............................................Passed
🚨 Ban Dangerous Test Masking (|| true, etc.)............................Passed
🔍 Comprehensive Security Check..........................................Passed
🔧 Multi-Layer Workflow Validation.......................................Passed
🧪 Workflow Execution Testing............................................Passed
